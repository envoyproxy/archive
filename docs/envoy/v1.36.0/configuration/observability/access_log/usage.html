

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Access logging &mdash; envoy tag-v1.36.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d7d10ef0" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/envoy.css?v=3ec0219e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4da122e5" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=ae221bf4"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../_static/copybutton.js?v=db7b0edf"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Security" href="../../security/security.html" />
    <link rel="prev" title="Statistics" href="stats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../http/http.html">HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../observability.html">Observability</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../statistics.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stat_sinks/stat_sinks.html">Stat sinks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../application_logging.html">Application logging</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="access_log.html">Access Logs</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="stats.html">Statistics</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Access logging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../security/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/operations.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_features/other_features.html">Other features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_protocols/other_protocols.html">Other protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/best_practices.html">Configuration best practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../configuration.html">Configuration reference</a></li>
          <li class="breadcrumb-item"><a href="../observability.html">Observability</a></li>
          <li class="breadcrumb-item"><a href="access_log.html">Access Logs</a></li>
      <li class="breadcrumb-item active">Access logging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/configuration/observability/access_log/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <blockquote>
<div></div></blockquote>
<section id="access-logging">
<span id="config-access-log"></span><h1>Access logging<a class="headerlink" href="#access-logging" title="Link to this heading"></a></h1>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading"></a></h2>
<p>Access logs are configured as part of the <a class="reference internal" href="../../http/http_conn_man/http_conn_man.html#config-http-conn-man"><span class="std std-ref">HTTP connection manager config</span></a>, <a class="reference internal" href="../../listeners/network_filters/tcp_proxy_filter.html#config-network-filters-tcp-proxy"><span class="std std-ref">TCP Proxy</span></a>,
<a class="reference internal" href="../../listeners/udp_filters/udp_proxy.html#config-udp-listener-filters-udp-proxy"><span class="std std-ref">UDP Proxy</span></a> or
<a class="reference internal" href="../../listeners/network_filters/thrift_proxy_filter.html#config-network-filters-thrift-proxy"><span class="std std-ref">Thrift Proxy</span></a>.</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api-v3/config/accesslog/v3/accesslog.proto.html#envoy-v3-api-msg-config-accesslog-v3-accesslog"><span class="std std-ref">v3 API reference</span></a></p></li>
</ul>
</section>
<section id="format-rules">
<span id="config-access-log-format"></span><h2>Format Rules<a class="headerlink" href="#format-rules" title="Link to this heading"></a></h2>
<p>Access log formats contain command operators that extract the relevant data and insert it.
They support two formats: <a class="reference internal" href="#config-access-log-format-strings"><span class="std std-ref">“format strings”</span></a> and
<a class="reference internal" href="#config-access-log-format-dictionaries"><span class="std std-ref">“format dictionaries”</span></a>. In both cases, the command operators
are used to extract the relevant data, which is then inserted into the specified log format.
Only one access log format may be specified at a time.</p>
</section>
<section id="format-strings">
<span id="config-access-log-format-strings"></span><h2>Format Strings<a class="headerlink" href="#format-strings" title="Link to this heading"></a></h2>
<p>Format strings are plain strings, specified using the <code class="docutils literal notranslate"><span class="pre">format</span></code> key. They may contain
either command operators or other characters interpreted as a plain string.
The access log formatter does not make any assumptions about a new line separator, so one
has to specified as part of the format string.
See the <a class="reference internal" href="#config-access-log-default-format"><span class="std std-ref">default format</span></a> for an example.</p>
</section>
<section id="default-format-string">
<span id="config-access-log-default-format"></span><h2>Default Format String<a class="headerlink" href="#default-format-string" title="Link to this heading"></a></h2>
<p>If custom format string is not specified, Envoy uses the following default format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[%START_TIME%] &quot;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%&quot;
%RESPONSE_CODE% %RESPONSE_FLAGS% %BYTES_RECEIVED% %BYTES_SENT% %DURATION%
%RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% &quot;%REQ(X-FORWARDED-FOR)%&quot; &quot;%REQ(USER-AGENT)%&quot;
&quot;%REQ(X-REQUEST-ID)%&quot; &quot;%REQ(:AUTHORITY)%&quot; &quot;%UPSTREAM_HOST%&quot;\n
</pre></div>
</div>
<p>Example of the default Envoy access log format:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[2016-04-15T20:17:00.310Z] &quot;POST /api/v1/locations HTTP/2&quot; 204 - 154 0 226 100 &quot;10.0.35.28&quot;
&quot;nsq2http&quot; &quot;cc21d9b0-cf5c-432b-8c7e-98aeb7988cd2&quot; &quot;locations&quot; &quot;tcp://10.0.2.1:80&quot;
</pre></div>
</div>
</section>
<section id="format-dictionaries">
<span id="config-access-log-format-dictionaries"></span><h2>Format Dictionaries<a class="headerlink" href="#format-dictionaries" title="Link to this heading"></a></h2>
<p>Format dictionaries are dictionaries that specify a structured access log output format,
specified using the <code class="docutils literal notranslate"><span class="pre">json_format</span></code> or <code class="docutils literal notranslate"><span class="pre">typed_json_format</span></code> keys. This allows logs to be output in
a structured format such as JSON. Similar to format strings, command operators are evaluated and
their values inserted into the format dictionary to construct the log output.</p>
<p>For example, with the following format provided in the configuration as <code class="docutils literal notranslate"><span class="pre">json_format</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;json_format&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;%PROTOCOL%&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;%DURATION%&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;my_custom_header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;%REQ(MY_CUSTOM_HEADER)%&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following JSON object would be written to the log file:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;protocol&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HTTP/1.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;123&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;my_custom_header&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value_of_MY_CUSTOM_HEADER&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>This allows you to specify a custom key for each command operator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">typed_json_format</span></code> differs from <code class="docutils literal notranslate"><span class="pre">json_format</span></code> in that values are rendered as JSON numbers,
booleans, and nested objects or lists where applicable. In the example, the request duration
would be rendered as the number <code class="docutils literal notranslate"><span class="pre">123</span></code>.</p>
<p>Format dictionaries have the following restrictions:</p>
<ul class="simple">
<li><p>The dictionary must map strings to strings (specifically, strings to command operators). Nesting
is supported.</p></li>
<li><p>When using the <code class="docutils literal notranslate"><span class="pre">typed_json_format</span></code> command operators will only produce typed output if the
command operator is the only string that appears in the dictionary value. For example,
<code class="docutils literal notranslate"><span class="pre">&quot;%DURATION%&quot;</span></code> will log a numeric duration value, but <code class="docutils literal notranslate"><span class="pre">&quot;%DURATION%.0&quot;</span></code> will log a string
value.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using the <code class="docutils literal notranslate"><span class="pre">typed_json_format</span></code>, integer values that exceed <span class="math notranslate nohighlight">\(2^{53}\)</span> will be
represented with reduced precision as they must be converted to floating point numbers.</p>
</div>
</section>
<section id="command-operators">
<span id="config-access-log-command-operators"></span><h2>Command Operators<a class="headerlink" href="#command-operators" title="Link to this heading"></a></h2>
<p>Command operators are used to extract values that will be inserted into the access logs.
The same operators are used by different types of access logs (such as HTTP and TCP). Some
fields may have slightly different meanings, depending on what type of log it is. Differences
are noted.</p>
<p>Note that if a value is not set/empty, the logs will contain a <code class="docutils literal notranslate"><span class="pre">-</span></code> character or, for JSON logs,
the string <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code>. For typed JSON logs unset values are represented as <code class="docutils literal notranslate"><span class="pre">null</span></code> values and empty
strings are rendered as <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>. <a class="reference internal" href="../../../api-v3/config/core/v3/substitution_format_string.proto.html#envoy-v3-api-field-config-core-v3-substitutionformatstring-omit-empty-values"><span class="std std-ref">omit_empty_values</span></a> option could be used
to omit empty values entirely.</p>
<p>Unless otherwise noted, command operators produce string outputs for typed JSON logs.</p>
<p>The following command operators are supported:</p>
<dl id="config-access-log-format-start-time">
<dt>%START_TIME%</dt><dd><dl class="simple">
<dt>HTTP/THRIFT</dt><dd><p>Request start time including milliseconds.</p>
</dd>
<dt>TCP</dt><dd><p>Downstream connection start time including milliseconds.</p>
</dd>
<dt>UDP</dt><dd><p>UDP proxy session start time including milliseconds.</p>
</dd>
</dl>
<p>START_TIME can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
In addition to that, START_TIME also accepts following specifiers:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Specifier</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">%s</span></code></p></td>
<td><p>The number of seconds since the Epoch</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">%f</span></code>, <code class="docutils literal notranslate"><span class="pre">%[1-9]f</span></code></p></td>
<td><p>Fractional seconds digits, default is 9 digits (nanosecond)</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%3f</span></code> millisecond (3 digits)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%6f</span></code> microsecond (6 digits)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%9f</span></code> nanosecond (9 digits)</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Examples of formatting START_TIME is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>%START_TIME(%Y/%m/%dT%H:%M:%S%z)%

%START_TIME(%s)%

# To include millisecond fraction of the second (.000 ... .999). E.g. 1527590590.528.
%START_TIME(%s.%3f)%

%START_TIME(%s.%6f)%

%START_TIME(%s.%9f)%
</pre></div>
</div>
<p>In typed JSON logs, START_TIME is always rendered as a string.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-start-time-local">
<dt>%START_TIME_LOCAL%</dt><dd><p>Same as <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a>, but use local time zone.</p>
</dd>
</dl>
<dl id="config-access-log-format-emit-time">
<dt>%EMIT_TIME%</dt><dd><p>The time when log entry is emitted including milliseconds.</p>
<p>EMIT_TIME can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
See <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a> for additional format specifiers and examples.</p>
</dd>
</dl>
<dl id="config-access-log-format-emit-time-local">
<dt>%EMIT_TIME_LOCAL%</dt><dd><p>Same as <a class="reference internal" href="#config-access-log-format-emit-time"><span class="std std-ref">EMIT_TIME</span></a>, but use local time zone.</p>
</dd>
<dt>%REQUEST_HEADERS_BYTES%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Uncompressed bytes of request headers.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP/THRIFT</dt><dd><p>Body bytes received.</p>
</dd>
<dt>TCP</dt><dd><p>Downstream bytes received on connection.</p>
</dd>
<dt>UDP</dt><dd><p>Bytes received from the downstream in the UDP session.</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%BYTES_RETRANSMITTED%</dt><dd><dl class="simple">
<dt>HTTP/3 (QUIC)</dt><dd><p>Body bytes retransmitted.</p>
</dd>
<dt>HTTP/1 and HTTP/2</dt><dd><p>Not implemented (0).</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%PACKETS_RETRANSMITTED%</dt><dd><dl class="simple">
<dt>HTTP/3 (QUIC)</dt><dd><p>Number of packets retransmitted.</p>
</dd>
<dt>HTTP/1 and HTTP/2</dt><dd><p>Not implemented (0).</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%PROTOCOL%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Protocol. Currently either <em>HTTP/1.1</em> <em>HTTP/2</em> or <em>HTTP/3</em>.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>In typed JSON logs, PROTOCOL will render the string <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> if the protocol is not
available (e.g. in TCP logs).</p>
</dd>
<dt>%UPSTREAM_PROTOCOL%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Upstream protocol. Currently either <em>HTTP/1.1</em> <em>HTTP/2</em> or <em>HTTP/3</em>.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>In typed JSON logs, UPSTREAM_PROTOCOL will render the string <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> if the protocol is not
available (e.g. in TCP logs).</p>
</dd>
<dt>%RESPONSE_CODE%</dt><dd><dl>
<dt>HTTP</dt><dd><p>HTTP response code. Note that a response code of ‘0’ means that the server never sent the
beginning of a response. This generally means that the (downstream) client disconnected.</p>
<p>Note that in the case of 100-continue responses, only the response code of the final headers
will be logged. If a 100-continue is followed by a 200, the logged response will be 200.
If a 100-continue results in a disconnect, the 100 will be logged.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-response-code-details">
<dt>%RESPONSE_CODE_DETAILS(X)%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>HTTP response code details provides additional information about the response code, such as
who set it (the upstream or envoy) and why. The string will not contain any whitespaces, which
will be converted to underscore ‘_’, unless optional parameter X is ALLOW_WHITESPACES.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“)</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-connection-termination-details">
<dt>%CONNECTION_TERMINATION_DETAILS%</dt><dd><dl class="simple">
<dt>HTTP and TCP</dt><dd><p>Connection termination details may provide additional information about why the connection was
terminated by Envoy for L4 reasons.</p>
</dd>
</dl>
</dd>
<dt>%RESPONSE_HEADERS_BYTES%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Uncompressed bytes of response headers.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%RESPONSE_TRAILERS_BYTES%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Uncompressed bytes of response trailers.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP/THRIFT</dt><dd><p>Body bytes sent. For WebSocket connection it will also include response header bytes.</p>
</dd>
<dt>TCP</dt><dd><p>Downstream bytes sent on connection.</p>
</dd>
<dt>UDP</dt><dd><p>Bytes sent to the downstream in the UDP session.</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_REQUEST_ATTEMPT_COUNT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of times the request is attempted upstream. Note that an attempt count of ‘0’ means that
the request was never attempted upstream.</p>
</dd>
<dt>TCP</dt><dd><p>Number of times the connection request is attempted upstream. Note that an attempt count of ‘0’
means that the connection request was never attempted upstream.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%UPSTREAM_WIRE_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total number of bytes sent to the upstream by the http stream.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of bytes sent to the upstream by the tcp proxy.</p>
</dd>
<dt>UDP</dt><dd><p>Total number of bytes sent to the upstream stream, For UDP tunneling flows. Not supported for non-tunneling.</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_WIRE_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total number of bytes received from the upstream by the http stream.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of bytes received from the upstream by the tcp proxy.</p>
</dd>
<dt>UDP</dt><dd><p>Total number of bytes received from the upstream stream, For UDP tunneling flows. Not supported for non-tunneling.</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_HEADER_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of header bytes sent to the upstream by the http stream.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of HTTP header bytes sent to the upstream stream, for TCP tunneling flows. Not supported for non-tunneling.</p>
</dd>
<dt>UDP</dt><dd><p>Total number of HTTP header bytes sent to the upstream stream, For UDP tunneling flows. Not supported for non-tunneling.</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_DECOMPRESSED_HEADER_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of decompressed header bytes sent to the upstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_HEADER_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of header bytes received from the upstream by the http stream.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of HTTP header bytes received from the upstream stream, for TCP tunneling flows. Not supported for non-tunneling.</p>
</dd>
<dt>UDP</dt><dd><p>Total number of HTTP header bytes received from the upstream stream, For UDP tunneling flows. Not supported for non-tunneling.</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_DECOMPRESSED_HEADER_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of decompressed header bytes received from the upstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_WIRE_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total number of bytes sent to the downstream by the http stream.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of bytes sent to the downstream by the tcp proxy.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_WIRE_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total number of bytes received from the downstream by the http stream. Envoy over counts sizes of received HTTP/1.1 pipelined requests by adding up bytes of requests in the pipeline to the one currently being processed.</p>
</dd>
<dt>TCP</dt><dd><p>Total number of bytes received from the downstream by the tcp proxy.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_HEADER_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of header bytes sent to the downstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_DECOMPRESSED_HEADER_BYTES_SENT%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of decompressed header bytes sent to the downstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_HEADER_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of header bytes received from the downstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%DOWNSTREAM_DECOMPRESSED_HEADER_BYTES_RECEIVED%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Number of decompressed header bytes received from the downstream by the http stream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-duration">
<dt>%DURATION%</dt><dd><dl class="simple">
<dt>HTTP/THRIFT</dt><dd><p>Total duration in milliseconds of the request from the start time to the last byte out.</p>
</dd>
<dt>TCP</dt><dd><p>Total duration in milliseconds of the downstream connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
</dl>
<dl id="config-access-log-format-common-duration">
<dt>%COMMON_DURATION(START:END:PRECISION)%</dt><dd><dl>
<dt>HTTP</dt><dd><p>Total duration between the START time point and the END time point in specific PRECISION.
The START and END time points are specified by the following values (NOTE: all values
here are case-sensitive):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DS_RX_BEG</span></code>: The time point of the downstream request receiving begin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DS_RX_END</span></code>: The time point of the downstream request receiving end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_CX_BEG</span></code>: The time point of the upstream TCP connect begin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_CX_END</span></code>: The time point of the upstream TCP connect end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_HS_END</span></code>: The time point of the upstream TLS handshake end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_TX_BEG</span></code>: The time point of the upstream request sending begin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_TX_END</span></code>: The time point of the upstream request sending end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_RX_BEG</span></code>: The time point of the upstream response receiving begin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_RX_END</span></code>: The time point of the upstream response receiving end.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DS_TX_BEG</span></code>: The time point of the downstream response sending begin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DS_TX_END</span></code>: The time point of the downstream response sending end.</p></li>
<li><p>Dynamic value: Other values will be treated as custom time points that are set by named keys.</p></li>
</ul>
<p>NOTE: Upstream connection establishment time points (US_CX_*, US_HS_END) repeat for all requests
in a given connection.</p>
<p>The PRECISION is specified by the following values (NOTE: all values here are case-sensitive):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ms</span></code>: Millisecond precision.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">us</span></code>: Microsecond precision.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ns</span></code>: Nanosecond precision.</p></li>
</ul>
<p>NOTE: enabling independent half-close behavior for H/2 and H/3 protocols can produce
<code class="docutils literal notranslate"><span class="pre">*_TX_END</span></code> values lower than <code class="docutils literal notranslate"><span class="pre">*_RX_END</span></code> values, in cases where upstream peer has half-closed
its stream before downstream peer. In these cases <code class="docutils literal notranslate"><span class="pre">COMMON_DURATION</span></code> value will become negative.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%REQUEST_DURATION%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total duration in milliseconds of the request from the start time to the last byte of
the request received from the downstream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%REQUEST_TX_DURATION%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total duration in milliseconds of the request from the start time to the last byte sent upstream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%RESPONSE_DURATION%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total duration in milliseconds of the request from the start time to the first byte read from the
upstream host.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%ROUNDTRIP_DURATION%</dt><dd><dl class="simple">
<dt>HTTP/3 (QUIC)</dt><dd><p>Total duration in milliseconds of the request from the start time to receiving the final ack from
the downstream.</p>
</dd>
<dt>HTTP/1 and HTTP/2</dt><dd><p>Not implemented (“-“).</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%RESPONSE_TX_DURATION%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Total duration in milliseconds of the request from the first byte read from the upstream host to the last
byte sent downstream.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%DOWNSTREAM_HANDSHAKE_DURATION%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Not implemented (“-“).</p>
</dd>
<dt>TCP</dt><dd><p>Total duration in milliseconds from the start of the connection to the TLS handshake being completed.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
<dt>%UPSTREAM_CONNECTION_POOL_READY_DURATION%</dt><dd><dl class="simple">
<dt>HTTP/TCP</dt><dd><p>Total duration in milliseconds from when the upstream request was created to when the connection pool is ready.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>Renders a numeric value in typed JSON logs.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-response-flags">
<dt>%RESPONSE_FLAGS% / %RESPONSE_FLAGS_LONG%</dt><dd><p>Additional details about the response or connection, if any. For TCP connections, the response codes mentioned in
the descriptions do not apply. %RESPONSE_FLAGS% will output a short string. %RESPONSE_FLAGS_LONG% will output a Pascal case string.
Possible values are:</p>
</dd>
</dl>
<p>HTTP and TCP</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Long name</p></th>
<th class="head"><p>Short name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>NoHealthyUpstream</strong></p></td>
<td><p><strong>UH</strong></p></td>
<td><p>No healthy upstream hosts in upstream cluster in addition to 503 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>UpstreamConnectionFailure</strong></p></td>
<td><p><strong>UF</strong></p></td>
<td><p>Upstream connection failure in addition to 503 response code.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UpstreamOverflow</strong></p></td>
<td><p><strong>UO</strong></p></td>
<td><p>Upstream overflow (<a class="reference internal" href="../../../intro/arch_overview/upstream/circuit_breaking.html#arch-overview-circuit-break"><span class="std std-ref">circuit breaking</span></a>) in addition to 503 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NoRouteFound</strong></p></td>
<td><p><strong>NR</strong></p></td>
<td><p>No <a class="reference internal" href="../../../intro/arch_overview/http/http_routing.html#arch-overview-http-routing"><span class="std std-ref">route configured</span></a> for a given request in addition to 404 response code or no matching filter chain for a downstream connection.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UpstreamRetryLimitExceeded</strong></p></td>
<td><p><strong>URX</strong></p></td>
<td><p>The request was rejected because the <a class="reference internal" href="../../../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-retrypolicy-num-retries"><span class="std std-ref">upstream retry limit (HTTP)</span></a>  or <a class="reference internal" href="../../../api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-max-connect-attempts"><span class="std std-ref">maximum connect attempts (TCP)</span></a> was reached.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NoClusterFound</strong></p></td>
<td><p><strong>NC</strong></p></td>
<td><p>Upstream cluster not found.</p></td>
</tr>
<tr class="row-even"><td><p><strong>DurationTimeout</strong></p></td>
<td><p><strong>DT</strong></p></td>
<td><p>When a request or connection exceeded <a class="reference internal" href="../../../api-v3/config/core/v3/protocol.proto.html#envoy-v3-api-field-config-core-v3-httpprotocoloptions-max-connection-duration"><span class="std std-ref">max_connection_duration</span></a> or <a class="reference internal" href="../../../api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-max-downstream-connection-duration"><span class="std std-ref">max_downstream_connection_duration</span></a>.</p></td>
</tr>
</tbody>
</table>
<p>HTTP only</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Long name</p></th>
<th class="head"><p>Short name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>DownstreamConnectionTermination</strong></p></td>
<td><p><strong>DC</strong></p></td>
<td><p>Downstream connection termination.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>FailedLocalHealthCheck</strong></p></td>
<td><p><strong>LH</strong></p></td>
<td><p>Local service failed <a class="reference internal" href="../../../intro/arch_overview/upstream/health_checking.html#arch-overview-health-checking"><span class="std std-ref">health check request</span></a> in addition to 503 response code.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UpstreamRequestTimeout</strong></p></td>
<td><p><strong>UT</strong></p></td>
<td><p>Upstream request timeout in addition to 504 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>LocalReset</strong></p></td>
<td><p><strong>LR</strong></p></td>
<td><p>Connection local reset in addition to 503 response code.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UpstreamRemoteReset</strong></p></td>
<td><p><strong>UR</strong></p></td>
<td><p>Upstream remote reset in addition to 503 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>UpstreamConnectionTermination</strong></p></td>
<td><p><strong>UC</strong></p></td>
<td><p>Upstream connection termination in addition to 503 response code.</p></td>
</tr>
<tr class="row-even"><td><p><strong>DelayInjected</strong></p></td>
<td><p><strong>DI</strong></p></td>
<td><p>The request processing was delayed for a period specified via <a class="reference internal" href="../../http/http_filters/fault_filter.html#config-http-filters-fault-injection"><span class="std std-ref">fault injection</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>FaultInjected</strong></p></td>
<td><p><strong>FI</strong></p></td>
<td><p>The request was aborted with a response code specified via <a class="reference internal" href="../../http/http_filters/fault_filter.html#config-http-filters-fault-injection"><span class="std std-ref">fault injection</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>RateLimited</strong></p></td>
<td><p><strong>RL</strong></p></td>
<td><p>The request was rate-limited locally by the <a class="reference internal" href="../../http/http_filters/rate_limit_filter.html#config-http-filters-rate-limit"><span class="std std-ref">HTTP rate limit filter</span></a> in addition to 429 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>UnauthorizedExternalService</strong></p></td>
<td><p><strong>UAEX</strong></p></td>
<td><p>The request was denied by the external authorization service.</p></td>
</tr>
<tr class="row-even"><td><p><strong>RateLimitServiceError</strong></p></td>
<td><p><strong>RLSE</strong></p></td>
<td><p>The request was rejected because there was an error in rate limit service.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>InvalidEnvoyRequestHeaders</strong></p></td>
<td><p><strong>IH</strong></p></td>
<td><p>The request was rejected because it set an invalid value for a <a class="reference internal" href="../../../api-v3/extensions/filters/http/router/v3/router.proto.html#envoy-v3-api-field-extensions-filters-http-router-v3-router-strict-check-headers"><span class="std std-ref">strictly-checked header</span></a> in addition to 400 response code.</p></td>
</tr>
<tr class="row-even"><td><p><strong>StreamIdleTimeout</strong></p></td>
<td><p><strong>SI</strong></p></td>
<td><p>Stream idle timeout in addition to 408 or 504 response code.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DownstreamProtocolError</strong></p></td>
<td><p><strong>DPE</strong></p></td>
<td><p>The downstream request had an HTTP protocol error.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UpstreamProtocolError</strong></p></td>
<td><p><strong>UPE</strong></p></td>
<td><p>The upstream response had an HTTP protocol error.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>UpstreamMaxStreamDurationReached</strong></p></td>
<td><p><strong>UMSDR</strong></p></td>
<td><p>The upstream request reached max stream duration.</p></td>
</tr>
<tr class="row-even"><td><p><strong>ResponseFromCacheFilter</strong></p></td>
<td><p><strong>RFCF</strong></p></td>
<td><p>The response was served from an Envoy cache filter.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>NoFilterConfigFound</strong></p></td>
<td><p><strong>NFCF</strong></p></td>
<td><p>The request is terminated because filter configuration was not received within the permitted warming deadline.</p></td>
</tr>
<tr class="row-even"><td><p><strong>OverloadManagerTerminated</strong></p></td>
<td><p><strong>OM</strong></p></td>
<td><p>Overload Manager terminated the request.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DnsResolutionFailed</strong></p></td>
<td><p><strong>DF</strong></p></td>
<td><p>The request was terminated due to DNS resolution failure.</p></td>
</tr>
<tr class="row-even"><td><p><strong>DropOverload</strong></p></td>
<td><p><strong>DO</strong></p></td>
<td><p>The request was terminated in addition to 503 response code due to <a class="reference internal" href="../../../api-v3/config/endpoint/v3/endpoint.proto.html#envoy-v3-api-field-config-endpoint-v3-clusterloadassignment-policy-drop-overloads"><span class="std std-ref">drop_overloads</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>DownstreamRemoteReset</strong></p></td>
<td><p><strong>DR</strong></p></td>
<td><p>The response details are <code class="docutils literal notranslate"><span class="pre">http2.remote_reset</span></code> or <code class="docutils literal notranslate"><span class="pre">http2.remote_refuse</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>UnconditionalDropOverload</strong></p></td>
<td><p><strong>UDO</strong></p></td>
<td><p>The request was terminated in addition to 503 response code due to <a class="reference internal" href="../../../api-v3/config/endpoint/v3/endpoint.proto.html#envoy-v3-api-field-config-endpoint-v3-clusterloadassignment-policy-drop-overloads"><span class="std std-ref">drop_overloads</span></a> is set to 100%.</p></td>
</tr>
</tbody>
</table>
<dl class="simple">
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
<dt>%ROUTE_NAME%</dt><dd><dl class="simple">
<dt>HTTP/TCP</dt><dd><p>Name of the route.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%VIRTUAL_CLUSTER_NAME%</dt><dd><dl class="simple">
<dt>HTTP*/gRPC</dt><dd><p>Name of the matched Virtual Cluster (if any).</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-host">
<dt>%UPSTREAM_HOST%</dt><dd><p>Main address of upstream host (e.g., ip:port for TCP connections).</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-host-name">
<dt>%UPSTREAM_HOST_NAME%</dt><dd><p>Upstream host name (e.g., DNS name). If no DNS name is available, the main address of the upstream host
(e.g., ip:port for TCP connections) will be used.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-host-name-without-port">
<dt>%UPSTREAM_HOST_NAME_WITHOUT_PORT%</dt><dd><p>Upstream host name (e.g., DNS name) without port component. If no DNS name is available,
the main address of the upstream host (e.g., ip for TCP connections) will be used.</p>
</dd>
<dt>%UPSTREAM_CLUSTER%</dt><dd><p>Upstream cluster to which the upstream host belongs to. <a class="reference internal" href="../../../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-alt-stat-name"><span class="std std-ref">alt_stat_name</span></a> will be used if provided.</p>
</dd>
<dt>%UPSTREAM_CLUSTER_RAW%</dt><dd><p>Upstream cluster to which the upstream host belongs to. <a class="reference internal" href="../../../api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-alt-stat-name"><span class="std std-ref">alt_stat_name</span></a> does NOT modify this value.</p>
</dd>
<dt>%UPSTREAM_LOCAL_ADDRESS%</dt><dd><p>Local address of the upstream connection. If the address is an IP address it includes both
address and port.</p>
</dd>
<dt>%UPSTREAM_LOCAL_ADDRESS_WITHOUT_PORT%</dt><dd><p>Local address of the upstream connection, without any port component.
IP addresses are the only address type with a port component.</p>
</dd>
<dt>%UPSTREAM_LOCAL_PORT%</dt><dd><p>Local port of the upstream connection.
IP addresses are the only address type with a port component.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-remote-address">
<dt>%UPSTREAM_REMOTE_ADDRESS%</dt><dd><p>Remote address of the upstream connection. If the address is an IP address it includes both
address and port. Identical to the <a class="reference internal" href="#config-access-log-format-upstream-host"><span class="std std-ref">UPSTREAM_HOST</span></a> value if the upstream
host only has one address and connection is established successfully.</p>
</dd>
<dt>%UPSTREAM_REMOTE_ADDRESS_WITHOUT_PORT%</dt><dd><p>Remote address of the upstream connection, without any port component.
IP addresses are the only address type with a port component.</p>
</dd>
<dt>%UPSTREAM_REMOTE_PORT%</dt><dd><p>Remote port of the upstream connection.
IP addresses are the only address type with a port component.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-transport-failure-reason">
<dt>%UPSTREAM_TRANSPORT_FAILURE_REASON%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>If upstream connection failed due to transport socket (e.g. TLS handshake), provides the failure
reason from the transport socket. The format of this field depends on the configured upstream
transport socket. Common TLS failures are in <a class="reference internal" href="../../../intro/arch_overview/security/ssl.html#arch-overview-ssl-trouble-shooting"><span class="std std-ref">TLS trouble shooting</span></a>.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“)</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-downstream-transport-failure-reason">
<dt>%DOWNSTREAM_TRANSPORT_FAILURE_REASON%</dt><dd><dl class="simple">
<dt>HTTP/TCP</dt><dd><p>If downstream connection failed due to transport socket (e.g. TLS handshake), provides the failure
reason from the transport socket. The format of this field depends on the configured downstream
transport socket. Common TLS failures are in <a class="reference internal" href="../../../intro/arch_overview/security/ssl.html#arch-overview-ssl-trouble-shooting"><span class="std std-ref">TLS trouble shooting</span></a>.
Note: it only works in listener access config, and the HTTP or TCP access logs would observe empty values.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“)</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_REMOTE_ADDRESS%</dt><dd><p>Remote address of the downstream connection. If the address is an IP address it includes both
address and port.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical remote address of the peer if the address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a> or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_REMOTE_ADDRESS_WITHOUT_PORT%</dt><dd><p>Remote address of the downstream connection, without any port component.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical remote address of the peer if the address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a> or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_REMOTE_PORT%</dt><dd><p>Remote port of the downstream connection.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical remote address of the peer if the address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a> or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_REMOTE_ADDRESS%</dt><dd><p>Direct remote address of the downstream connection. If the address is an IP address it includes both
address and port.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the physical remote address of the peer even if the downstream remote address has
been inferred from <a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>
or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_REMOTE_ADDRESS_WITHOUT_PORT%</dt><dd><p>Direct remote address of the downstream connection, without any port component.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the physical remote address of the peer even if the downstream remote address has
been inferred from <a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>
or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_REMOTE_PORT%</dt><dd><p>Direct remote port of the downstream connection.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the physical remote address of the peer even if the downstream remote address has
been inferred from <a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>
or <a class="reference internal" href="../../http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_LOCAL_ADDRESS%</dt><dd><p>Local address of the downstream connection. If the address is an IP address it includes both
address and port.</p>
<p>If the original connection was redirected by iptables REDIRECT, this represents
the original destination address restored by the
<a class="reference internal" href="../../listeners/listener_filters/original_dst_filter.html#config-listener-filters-original-dst"><span class="std std-ref">Original Destination Filter</span></a> using SO_ORIGINAL_DST socket option.
If the original connection was redirected by iptables TPROXY, and the listener’s transparent
option was set to true, this represents the original destination address and port.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical remote address of the peer if the address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_LOCAL_ADDRESS%</dt><dd><p>Direct local address of the downstream connection.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the physical local address even if the downstream remote address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_LOCAL_ADDRESS_WITHOUT_PORT%</dt><dd><p>Local address of the downstream connection, without any port component.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical local address if the downstream local address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_LOCAL_ADDRESS_WITHOUT_PORT%</dt><dd><p>Direct local address of the downstream connection, without any port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the physical local address even if the downstream local address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_LOCAL_PORT%</dt><dd><p>Local port of the downstream connection.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This may not be the physical port if the downstream local address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
<dt>%DOWNSTREAM_DIRECT_LOCAL_PORT%</dt><dd><p>Direct local port of the downstream connection.
IP addresses are the only address type with a port component.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is always the listener port even if the downstream local address has been inferred from
<a class="reference internal" href="../../listeners/listener_filters/proxy_protocol.html#config-listener-filters-proxy-protocol"><span class="std std-ref">Proxy Protocol filter</span></a>.</p>
</div>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-connection-id">
<dt>%CONNECTION_ID%</dt><dd><p>An identifier for the downstream connection. It can be used to
cross-reference TCP access logs across multiple log sinks, or to
cross-reference timer-based reports for the same connection. The identifier
is unique with high likelihood within an execution, but can duplicate across
multiple instances or between restarts.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-upstream-connection-id">
<dt>%UPSTREAM_CONNECTION_ID%</dt><dd><p>An identifier for the upstream connection. It can be used to
cross-reference TCP access logs across multiple log sinks, or to
cross-reference timer-based reports for the same connection. The identifier
is unique with high likelihood within an execution, but can duplicate across
multiple instances or between restarts.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-stream-id">
<dt>%STREAM_ID%</dt><dd><p>An identifier for the stream (HTTP request, long-live HTTP2 stream, TCP connection, etc.). It can be used to
cross-reference TCP access logs across multiple log sinks, or to cross-reference timer-based reports for the same connection.
Different with %CONNECTION_ID%, the identifier should be unique across multiple instances or between restarts.
And it’s value should be same with %REQ(X-REQUEST-ID)% for HTTP request.
This should be used to replace %CONNECTION_ID% and %REQ(X-REQUEST-ID)% in most cases.</p>
</dd>
<dt>%GRPC_STATUS(X)%</dt><dd><p><a class="reference external" href="https://github.com/googleapis/googleapis/blob/master/google/rpc/code.proto">gRPC status code</a> formatted according to the optional parameter <code class="docutils literal notranslate"><span class="pre">X</span></code>, which can be <code class="docutils literal notranslate"><span class="pre">CAMEL_STRING</span></code>, <code class="docutils literal notranslate"><span class="pre">SNAKE_STRING</span></code> and <code class="docutils literal notranslate"><span class="pre">NUMBER</span></code>.
For example, if the grpc status is <code class="docutils literal notranslate"><span class="pre">INVALID_ARGUMENT</span></code> (represented by number 3), the formatter will return <code class="docutils literal notranslate"><span class="pre">InvalidArgument</span></code> for <code class="docutils literal notranslate"><span class="pre">CAMEL_STRING</span></code>, <code class="docutils literal notranslate"><span class="pre">INVALID_ARGUMENT</span></code> for <code class="docutils literal notranslate"><span class="pre">SNAKE_STRING</span></code> and <code class="docutils literal notranslate"><span class="pre">3</span></code> for <code class="docutils literal notranslate"><span class="pre">NUMBER</span></code>.
If <code class="docutils literal notranslate"><span class="pre">X</span></code> isn’t provided, <code class="docutils literal notranslate"><span class="pre">CAMEL_STRING</span></code> will be used.</p>
</dd>
<dt>%GRPC_STATUS_NUMBER%</dt><dd><p>gRPC status code.</p>
</dd>
</dl>
<dl class="simple" id="config-access-log-format-req">
<dt>%REQ(X?Y):Z%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>An HTTP request header where X is the main HTTP header, Y is the alternative one, and Z is an
optional parameter denoting string truncation up to Z characters long. The value is taken from
the HTTP request header named X first and if it’s not set, then request header Y is used. If
none of the headers are present <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> symbol will be in the log.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%RESP(X?Y):Z%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Same as <strong>%REQ(X?Y):Z%</strong> but taken from HTTP response headers.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%TRAILER(X?Y):Z%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>Same as <strong>%REQ(X?Y):Z%</strong> but taken from HTTP response trailers.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-dynamic-metadata">
<dt>%DYNAMIC_METADATA(NAMESPACE:KEY*):Z%</dt><dd><dl>
<dt>HTTP</dt><dd><p><a class="reference internal" href="../../../api-v3/config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">Dynamic Metadata</span></a> info,
where NAMESPACE is the filter namespace used when setting the metadata, KEY is an optional
lookup key in the namespace with the option of specifying nested keys separated by ‘:’,
and Z is an optional parameter denoting string truncation up to Z characters long. Dynamic Metadata
can be set by filters using the <a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.36.0/envoy/stream_info/stream_info.h">StreamInfo</a> API:
<em>setDynamicMetadata</em>. The data will be logged as a JSON string. For example, for the following dynamic metadata:</p>
<p><code class="docutils literal notranslate"><span class="pre">com.test.my_filter:</span> <span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p>
<ul class="simple">
<li><p>%DYNAMIC_METADATA(com.test.my_filter)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.test.my_filter:test_key)% will log: <code class="docutils literal notranslate"><span class="pre">foo</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.test.my_filter:test_object)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.test.my_filter:test_object:inner_key)% will log: <code class="docutils literal notranslate"><span class="pre">bar</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.unknown_filter)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.test.my_filter:unknown_key)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%DYNAMIC_METADATA(com.test.my_filter):25% will log (truncation at 25 characters): <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test</span></code></p></li>
</ul>
</dd>
<dt>TCP</dt><dd><p>Not implemented (“-“).</p>
</dd>
<dt>UDP</dt><dd><p>For <a class="reference internal" href="../../listeners/udp_filters/udp_proxy.html#config-udp-listener-filters-udp-proxy"><span class="std std-ref">UDP Proxy</span></a>,
when NAMESPACE is set to “udp.proxy.session”, optional KEYs are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cluster_name</span></code>: Name of the cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytes_sent</span></code>: Total number of bytes sent to the downstream in the session. <em>Deprecated, use %BYTES_SENT% instead.</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytes_received</span></code>: Total number of bytes received from the downstream in the session. <em>Deprecated, use %BYTES_RECEIVED% instead.</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errors_sent</span></code>: Number of errors that have occurred when sending datagrams to the downstream in the session.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datagrams_sent</span></code>: Number of datagrams sent to the downstream in the session.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datagrams_received</span></code>: Number of datagrams received from the downstream in the session.</p></li>
</ul>
<p>Recommended session access log format for UDP proxy:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[%START_TIME%] %DYNAMIC_METADATA(udp.proxy.session:cluster_name)%
%DYNAMIC_METADATA(udp.proxy.session:bytes_sent)%
%DYNAMIC_METADATA(udp.proxy.session:bytes_received)%
%DYNAMIC_METADATA(udp.proxy.session:errors_sent)%
%DYNAMIC_METADATA(udp.proxy.session:datagrams_sent)%
%DYNAMIC_METADATA(udp.proxy.session:datagrams_received)%\n
</pre></div>
</div>
<p>when NAMESPACE is set to “udp.proxy.proxy”, optional KEYs are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bytes_sent</span></code>: Total number of bytes sent to the downstream in UDP proxy. <em>Deprecated, use %BYTES_SENT% instead.</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytes_received</span></code>: Total number of bytes received from the downstream in UDP proxy. <em>Deprecated, use %BYTES_RECEIVED% instead.</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errors_sent</span></code>: Number of errors that have occurred when sending datagrams to the downstream in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">errors_received</span></code>: Number of errors that have occurred when receiving datagrams from the downstream in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datagrams_sent</span></code>: Number of datagrams sent to the downstream in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datagrams_received</span></code>: Number of datagrams received from the downstream in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no_route</span></code>: Number of times that no upstream cluster found in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">session_total</span></code>: Total number of sessions in UDP proxy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idle_timeout</span></code>: Number of times that sessions idle timeout occurred in UDP proxy.</p></li>
</ul>
<p>Recommended proxy access log format for UDP proxy:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[%START_TIME%]
%DYNAMIC_METADATA(udp.proxy.proxy:bytes_sent)%
%DYNAMIC_METADATA(udp.proxy.proxy:bytes_received)%
%DYNAMIC_METADATA(udp.proxy.proxy:errors_sent)%
%DYNAMIC_METADATA(udp.proxy.proxy:errors_received)%
%DYNAMIC_METADATA(udp.proxy.proxy:datagrams_sent)%
%DYNAMIC_METADATA(udp.proxy.proxy:datagrams_received)%
%DYNAMIC_METADATA(udp.proxy.proxy:session_total)%\n
</pre></div>
</div>
</dd>
<dt>THRIFT</dt><dd><p>For <a class="reference internal" href="../../listeners/network_filters/thrift_proxy_filter.html#config-network-filters-thrift-proxy"><span class="std std-ref">Thrift Proxy</span></a>,
NAMESPACE should be always set to “thrift.proxy”, optional KEYs are as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: Name of the method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cluster_name</span></code>: Name of the cluster.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">passthrough</span></code>: Passthrough support for the request and response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request:transport_type</span></code>: The transport type of the request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request:protocol_type</span></code>: The protocol type of the request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">request:message_type</span></code>: The message type of the request.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response:transport_type</span></code>: The transport type of the response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response:protocol_type</span></code>: The protocol type of the response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response:message_type</span></code>: The message type of the response.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">response:reply_type</span></code>: The reply type of the response.</p></li>
</ul>
<p>Recommended access log format for Thrift proxy:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[%START_TIME%] %DYNAMIC_METADATA(thrift.proxy:method)%
%DYNAMIC_METADATA(thrift.proxy:cluster)%
%DYNAMIC_METADATA(thrift.proxy:request:transport_type)%
%DYNAMIC_METADATA(thrift.proxy:request:protocol_type)%
%DYNAMIC_METADATA(thrift.proxy:request:message_type)%
%DYNAMIC_METADATA(thrift.proxy:response:transport_type)%
%DYNAMIC_METADATA(thrift.proxy:response:protocol_type)%
%DYNAMIC_METADATA(thrift.proxy:response:message_type)%
%DYNAMIC_METADATA(thrift.proxy:response:reply_type)%
%BYTES_RECEIVED%
%BYTES_SENT%
%DURATION%
%UPSTREAM_HOST%\n
</pre></div>
</div>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For typed JSON logs, this operator renders a single value with string, numeric, or boolean type
when the referenced key is a simple value. If the referenced key is a struct or list value, a
JSON struct or list is rendered. Structs and lists may be nested. In any event, the maximum
length is ignored.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DYNAMIC_METADATA command operator will be deprecated in the future in favor of <a class="reference internal" href="../../../api-v3/extensions/formatter/metadata/v3/metadata.proto.html#envoy-v3-api-msg-extensions-formatter-metadata-v3-metadata"><span class="std std-ref">METADATA</span></a> operator.</p>
</div>
</dd>
</dl>
<dl id="config-access-log-format-cluster-metadata">
<dt>%CLUSTER_METADATA(NAMESPACE:KEY*):Z%</dt><dd><dl>
<dt>HTTP</dt><dd><p><a class="reference internal" href="../../../api-v3/config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">Upstream cluster Metadata</span></a> info,
where NAMESPACE is the filter namespace used when setting the metadata, KEY is an optional
lookup key in the namespace with the option of specifying nested keys separated by ‘:’,
and Z is an optional parameter denoting string truncation up to Z characters long. The data
will be logged as a JSON string. For example, for the following dynamic metadata:</p>
<p><code class="docutils literal notranslate"><span class="pre">com.test.my_filter:</span> <span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p>
<ul class="simple">
<li><p>%CLUSTER_METADATA(com.test.my_filter)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.test.my_filter:test_key)% will log: <code class="docutils literal notranslate"><span class="pre">foo</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.test.my_filter:test_object)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.test.my_filter:test_object:inner_key)% will log: <code class="docutils literal notranslate"><span class="pre">bar</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.unknown_filter)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.test.my_filter:unknown_key)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%CLUSTER_METADATA(com.test.my_filter):25% will log (truncation at 25 characters): <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test</span></code></p></li>
</ul>
</dd>
<dt>TCP/UDP/THRIFT</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For typed JSON logs, this operator renders a single value with string, numeric, or boolean type
when the referenced key is a simple value. If the referenced key is a struct or list value, a
JSON struct or list is rendered. Structs and lists may be nested. In any event, the maximum
length is ignored.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>CLUSTER_METADATA command operator will be deprecated in the future in favor of <a class="reference internal" href="../../../api-v3/extensions/formatter/metadata/v3/metadata.proto.html#envoy-v3-api-msg-extensions-formatter-metadata-v3-metadata"><span class="std std-ref">METADATA</span></a> operator.</p>
</div>
</dd>
</dl>
<dl id="config-access-log-format-upstream-host-metadata">
<dt>%UPSTREAM_METADATA(NAMESPACE:KEY*):Z%</dt><dd><dl>
<dt>HTTP/TCP</dt><dd><p><a class="reference internal" href="../../../api-v3/config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-metadata"><span class="std std-ref">Upstream host Metadata</span></a> info,
where NAMESPACE is the filter namespace used when setting the metadata, KEY is an optional
lookup key in the namespace with the option of specifying nested keys separated by ‘:’,
and Z is an optional parameter denoting string truncation up to Z characters long. The data
will be logged as a JSON string. For example, for the following upstream host metadata:</p>
<p><code class="docutils literal notranslate"><span class="pre">com.test.my_filter:</span> <span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p>
<ul class="simple">
<li><p>%UPSTREAM_METADATA(com.test.my_filter)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test_object&quot;:</span> <span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}}</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.test.my_filter:test_key)% will log: <code class="docutils literal notranslate"><span class="pre">foo</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.test.my_filter:test_object)% will log: <code class="docutils literal notranslate"><span class="pre">{&quot;inner_key&quot;:</span> <span class="pre">&quot;bar&quot;}</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.test.my_filter:test_object:inner_key)% will log: <code class="docutils literal notranslate"><span class="pre">bar</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.unknown_filter)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.test.my_filter:unknown_key)% will log: <code class="docutils literal notranslate"><span class="pre">-</span></code></p></li>
<li><p>%UPSTREAM_METADATA(com.test.my_filter):25% will log (truncation at 25 characters): <code class="docutils literal notranslate"><span class="pre">{&quot;test_key&quot;:</span> <span class="pre">&quot;foo&quot;,</span> <span class="pre">&quot;test</span></code></p></li>
</ul>
</dd>
<dt>UDP/THRIFT</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For typed JSON logs, this operator renders a single value with string, numeric, or boolean type
when the referenced key is a simple value. If the referenced key is a struct or list value, a
JSON struct or list is rendered. Structs and lists may be nested. In any event, the maximum
length is ignored.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>UPSTREAM_METADATA command operator will be deprecated in the future in favor of <a class="reference internal" href="../../../api-v3/extensions/formatter/metadata/v3/metadata.proto.html#envoy-v3-api-msg-extensions-formatter-metadata-v3-metadata"><span class="std std-ref">METADATA</span></a> operator.</p>
</div>
</dd>
</dl>
<dl id="config-access-log-format-filter-state">
<dt>%FILTER_STATE(KEY:F:FIELD?):Z%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p><a class="reference internal" href="../../../intro/arch_overview/advanced/data_sharing_between_filters.html#arch-overview-data-sharing-between-filters"><span class="std std-ref">Filter State</span></a> info, where the KEY is required to
look up the filter state object. The serialized proto will be logged as JSON string if possible.
If the serialized proto is unknown to Envoy it will be logged as protobuf debug string.
Z is an optional parameter denoting string truncation up to Z characters long.
F is an optional parameter used to indicate which method FilterState uses for serialization.
If <cite>PLAIN</cite> is set, the filter state object will be serialized as an unstructured string.
If <cite>TYPED</cite> is set or no F provided, the filter state object will be serialized as an JSON string.
If F is set to <cite>FIELD</cite>, the filter state object field with the name FIELD will be serialized.
FIELD parameter should only be used with F set to <cite>FIELD</cite>.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Same as HTTP, the filter state is from connection instead of a L7 request.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For typed JSON logs, this operator renders a single value with string, numeric, or boolean type
when the referenced key is a simple value. If the referenced key is a struct or list value, a
JSON struct or list is rendered. Structs and lists may be nested. In any event, the maximum
length is ignored</p>
</div>
</dd>
<dt>%UPSTREAM_FILTER_STATE(KEY:F:FIELD?):Z%</dt><dd><dl>
<dt>HTTP</dt><dd><p>Extracts filter state from upstream components like cluster or transport socket extensions.</p>
<p><a class="reference internal" href="../../../intro/arch_overview/advanced/data_sharing_between_filters.html#arch-overview-data-sharing-between-filters"><span class="std std-ref">Filter State</span></a> info, where the KEY is required to
look up the filter state object. The serialized proto will be logged as JSON string if possible.
If the serialized proto is unknown to Envoy it will be logged as protobuf debug string.
Z is an optional parameter denoting string truncation up to Z characters long.
F is an optional parameter used to indicate which method FilterState uses for serialization.
If <cite>PLAIN</cite> is set, the filter state object will be serialized as an unstructured string.
If <cite>TYPED</cite> is set or no F provided, the filter state object will be serialized as an JSON string.
If F is set to <cite>FIELD</cite>, the filter state object field with the name FIELD will be serialized.
FIELD parameter should only be used with F set to <cite>FIELD</cite>.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This command operator is only available for <a class="reference internal" href="../../../api-v3/extensions/filters/http/router/v3/router.proto.html#envoy-v3-api-field-extensions-filters-http-router-v3-router-upstream-log"><span class="std std-ref">upstream_log</span></a>.</p>
</div>
</dd>
<dt>%REQUESTED_SERVER_NAME%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>String value set on ssl connection socket for Server Name Indication (SNI)</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_IP_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The ip addresses present in the SAN of the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_IP_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The ip addresses present in the SAN of the peer certificate received from the downstream client to establish the
TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_DNS_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The DNS names present in the SAN of the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_DNS_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The DNS names present in the SAN of the peer certificate received from the downstream client to establish the
TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_URI_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The URIs present in the SAN of the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_URI_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The URIs present in the SAN of the peer certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_EMAIL_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The emails present in the SAN of the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_EMAIL_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The emails present in the SAN of the peer certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_OTHERNAME_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The OtherNames present in the SAN of the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_OTHERNAME_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The OtherNames present in the SAN of the peer certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_LOCAL_SUBJECT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The subject present in the local certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_SUBJECT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The subject present in the peer certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_ISSUER%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The issuer present in the peer certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_TLS_SESSION_ID%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The session ID for the established downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_TLS_CIPHER%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The OpenSSL name for the set of ciphers used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_TLS_VERSION%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The TLS version (e.g., <code class="docutils literal notranslate"><span class="pre">TLSv1.2</span></code>, <code class="docutils literal notranslate"><span class="pre">TLSv1.3</span></code>) used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_FINGERPRINT_256%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The hex-encoded SHA256 fingerprint of the client certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_FINGERPRINT_1%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The hex-encoded SHA1 fingerprint of the client certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_SERIAL%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The serial number of the client certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_CHAIN_FINGERPRINTS_256%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The comma-separated hex-encoded SHA256 fingerprints of all client certificates used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_CHAIN_FINGERPRINTS_1%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The comma-separated hex-encoded SHA1 fingerprints of all client certificates used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_CHAIN_SERIALS%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The comma-separated serial numbers of all client certificates used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%DOWNSTREAM_PEER_CERT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The client certificate in the URL-encoded PEM format used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%TLS_JA3_FINGERPRINT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/Thrift</dt><dd><p>The JA3 fingerprint (MD5 hash) of the TLS Client Hello message from the downstream connection.
Provides a way to fingerprint TLS clients based on various Client Hello parameters like cipher suites,
extensions, elliptic curves, etc. Will be <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> if TLS is not used or the handshake is incomplete.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%TLS_JA4_FINGERPRINT%</dt><dd><dl>
<dt>HTTP/TCP/THRIFT</dt><dd><p>The JA4 fingerprint of the TLS Client Hello message from the downstream connection. JA4 is an advanced TLS client
fingerprinting method that provides more granularity than JA3 by including the protocol version, cipher preference
order, and ALPN (Application-Layer Protocol Negotiation) protocols. This enhanced fingerprinting facilitates
improved threat hunting and security analysis.</p>
<p>The JA4 fingerprint follows the format <cite>a_b_c</cite>, where:</p>
<ul class="simple">
<li><p><strong>a</strong>: Represents the TLS protocol version and cipher preference order.</p></li>
<li><p><strong>b</strong>: Encodes the list of cipher suites offered by the client.</p></li>
<li><p><strong>c</strong>: Contains the ALPN protocols advertised by the client.</p></li>
</ul>
<p>This structured format allows for detailed analysis of client applications based on their TLS handshake
characteristics. It enables the identification of specific applications, underlying TLS libraries, and even
potential malicious activities by comparing fingerprints against known profiles.</p>
<p>If TLS is not used or the handshake is incomplete, the value of <code class="docutils literal notranslate"><span class="pre">%TLS_JA4_FINGERPRINT%</span></code> will be <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code>.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-downstream-peer-cert-v-start">
<dt>%DOWNSTREAM_PEER_CERT_V_START%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The validity start date of the client certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>DOWNSTREAM_PEER_CERT_V_START can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
See <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a> for additional format specifiers and examples.</p>
</dd>
</dl>
<dl id="config-access-log-format-downstream-peer-cert-v-end">
<dt>%DOWNSTREAM_PEER_CERT_V_END%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The validity end date of the client certificate used to establish the downstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>DOWNSTREAM_PEER_CERT_V_END can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
See <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a> for additional format specifiers and examples.</p>
</dd>
<dt>%UPSTREAM_PEER_SUBJECT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The subject present in the peer certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_PEER_ISSUER%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The issuer present in the peer certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_TLS_SESSION_ID%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The session ID for the established upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (0).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_TLS_CIPHER%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The OpenSSL name for the set of ciphers used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_TLS_VERSION%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The TLS version (e.g., <code class="docutils literal notranslate"><span class="pre">TLSv1.2</span></code>, <code class="docutils literal notranslate"><span class="pre">TLSv1.3</span></code>) used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_PEER_CERT%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The server certificate in the URL-encoded PEM format used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
</dl>
<dl id="config-access-log-format-upstream-peer-cert-v-start">
<dt>%UPSTREAM_PEER_CERT_V_START%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The validity start date of the upstream server certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>UPSTREAM_PEER_CERT_V_START can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
See <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a> for additional format specifiers and examples.</p>
</dd>
</dl>
<dl id="config-access-log-format-upstream-peer-cert-v-end">
<dt>%UPSTREAM_PEER_CERT_V_END%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The validity end date of the upstream server certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
<p>UPSTREAM_PEER_CERT_V_END can be customized using a <a class="reference external" href="https://en.cppreference.com/w/cpp/io/manip/put_time">format string</a>.
See <a class="reference internal" href="#config-access-log-format-start-time"><span class="std std-ref">START_TIME</span></a> for additional format specifiers and examples.</p>
</dd>
<dt>%UPSTREAM_PEER_URI_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The URIs present in the SAN of the peer certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_PEER_DNS_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The DNS names present in the SAN of the peer certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_PEER_IP_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The ip addresses present in the SAN of the peer certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_LOCAL_URI_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The URIs present in the SAN of the local certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_LOCAL_DNS_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The DNS names present in the SAN of the local certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%UPSTREAM_LOCAL_IP_SAN%</dt><dd><dl class="simple">
<dt>HTTP/TCP/THRIFT</dt><dd><p>The ip addresses present in the SAN of the local certificate used to establish the upstream TLS connection.</p>
</dd>
<dt>UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%HOSTNAME%</dt><dd><p>The system hostname.</p>
</dd>
<dt>%LOCAL_REPLY_BODY%</dt><dd><p>The body text for the requests rejected by the Envoy.</p>
</dd>
<dt>%FILTER_CHAIN_NAME%</dt><dd><p>The <a class="reference internal" href="../../../api-v3/config/listener/v3/listener_components.proto.html#envoy-v3-api-field-config-listener-v3-filterchain-name"><span class="std std-ref">network filter chain name</span></a> of the downstream connection.</p>
</dd>
</dl>
<dl id="config-access-log-format-access-log-type">
<dt>%ACCESS_LOG_TYPE%</dt><dd><p>The type of the access log, which indicates when the access log was recorded. If a non-supported log (from the list below),
uses this substitution string, then the value will be an empty string.</p>
<ul class="simple">
<li><p>TcpUpstreamConnected - When TCP Proxy filter has successfully established an upstream connection.</p></li>
<li><p>TcpPeriodic - On any TCP Proxy filter periodic log record.</p></li>
<li><p>TcpConnectionEnd - When a TCP connection is ended on TCP Proxy filter.</p></li>
<li><p>DownstreamStart - When HTTP Connection Manager filter receives a new HTTP request.</p></li>
<li><dl class="simple">
<dt>DownstreamTunnelSuccessfullyEstablished - When the HTTP Connection Manager sends response headers</dt><dd><p>indicating a successful HTTP tunnel.</p>
</dd>
</dl>
</li>
<li><p>DownstreamPeriodic - On any HTTP Connection Manager periodic log record.</p></li>
<li><p>DownstreamEnd - When an HTTP stream is ended on HTTP Connection Manager filter.</p></li>
<li><p>UpstreamPoolReady - When a new HTTP request is received by the HTTP Router filter.</p></li>
<li><p>UpstreamPeriodic - On any HTTP Router filter periodic log record.</p></li>
<li><p>UpstreamEnd - When an HTTP request is finished on the HTTP Router filter.</p></li>
<li><dl class="simple">
<dt>UdpTunnelUpstreamConnected - When UDP Proxy filter has successfully established an upstream connection.</dt><dd><p>Note: It is only relevant for UDP tunneling over HTTP.</p>
</dd>
</dl>
</li>
<li><p>UdpPeriodic - On any UDP Proxy filter periodic log record.</p></li>
<li><p>UdpSessionEnd - When a UDP session is ended on UDP Proxy filter.</p></li>
</ul>
</dd>
<dt>%UNIQUE_ID%</dt><dd><p>A unique identifier (UUID) that is generated dynamically.</p>
</dd>
<dt>%ENVIRONMENT(X):Z%</dt><dd><p>Environment value of environment variable X. If no valid environment variable X, <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> symbol will be used.
Z is an optional parameter denoting string truncation up to Z characters long.</p>
</dd>
<dt>%TRACE_ID%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>The trace ID of the request. If the request does not have a trace ID, this will be an empty string.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%QUERY_PARAM(X):Z%</dt><dd><dl class="simple">
<dt>HTTP</dt><dd><p>The value of the query parameter X. If the query parameter X is not present, <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> symbol will be used.
Z is an optional parameter denoting string truncation up to Z characters long.</p>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%PATH(X:Y):Z%</dt><dd><dl>
<dt>HTTP</dt><dd><p>The value of the request path. The parameter X is used to specify should the output contains
query or not. The parameter Y is used to specify the source of the request path. Both X and Y
are optional. And Z is an optional parameter denoting string truncation up to Z characters long.</p>
<p>The X parameter can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">WQ</span></code>: The output will be the full request path which contains the query parameters. If the X
is not present, <code class="docutils literal notranslate"><span class="pre">WQ</span></code> will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NQ</span></code>: The output will be the request path without the query parameters.</p></li>
</ul>
<p>The Y parameter can be:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ORIG</span></code>: Get the request path from the <code class="docutils literal notranslate"><span class="pre">x-envoy-original-path</span></code> header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PATH</span></code>: Get the request path from the <code class="docutils literal notranslate"><span class="pre">:path</span></code> header.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ORIG_OR_PATH</span></code>: Get the request path from the <code class="docutils literal notranslate"><span class="pre">x-envoy-original-path</span></code> header if it is
present, otherwise get it from the <code class="docutils literal notranslate"><span class="pre">:path</span></code> header. If the Y is not present, <code class="docutils literal notranslate"><span class="pre">ORIG_OR_PATH</span></code>
will be used.</p></li>
</ul>
</dd>
<dt>TCP/UDP</dt><dd><p>Not implemented (“-“).</p>
</dd>
</dl>
</dd>
<dt>%CUSTOM_FLAGS%</dt><dd><p>Custom flags set into the stream info. This could be used to log any custom event from the filters.
Multiple flags are separated by comma.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="stats.html" class="btn btn-neutral float-left" title="Statistics" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../security/security.html" class="btn btn-neutral float-right" title="Security" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>