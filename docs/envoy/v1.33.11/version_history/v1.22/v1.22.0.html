

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1.22.0 (April 15, 2022) &mdash; envoy tag-v1.33.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d7d10ef0" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/envoy.css?v=3ec0219e" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4da122e5" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5829c46c"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=db7b0edf"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="v1.21" href="../v1.21/v1.21.html" />
    <link rel="prev" title="1.22.1 (June 9, 2022)" href="v1.22.1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../version_history.html">Version history</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../version_history.html#stable-versions">Stable versions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../version_history.html#archived-versions">Archived versions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../v1.29/v1.29.html">v1.29: 1.29.12 (December 18, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.28/v1.28.html">v1.28: 1.28.7 (September 19, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.27/v1.27.html">v1.27: 1.27.7 (June 28, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.26/v1.26.html">v1.26: 1.26.8 (April 4, 2024)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.25/v1.25.html">v1.25: 1.25.11 (October 16, 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.24/v1.24.html">v1.24: 1.24.11 (October 10, 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.23/v1.23.html">v1.23: 1.23.12 (July 25, 2023)</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="v1.22.html">v1.22: 1.22.11 (April 11, 2023)</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="v1.22.11.html">1.22.11 (April 11, 2023)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.10.html">1.22.10 (April 4, 2023)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.9.html">1.22.9 (March 22, 2023)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.8.html">1.22.8 (February 24, 2023)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.7.html">1.22.7 (February 7, 2023)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.6.html">1.22.6 (November 30, 2022)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.5.html">1.22.5 (August 12, 2022)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.4.html">1.22.4 (July 27, 2022)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.3.html">1.22.3 (July 27, 2022)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.2.html">1.22.2 (June 10, 2022)</a></li>
<li class="toctree-l4"><a class="reference internal" href="v1.22.1.html">1.22.1 (June 9, 2022)</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">1.22.0 (April 15, 2022)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../v1.21/v1.21.html">v1.21: 1.21.6 (November 28, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.20/v1.20.html">v1.20: 1.20.7 (July 21, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.19/v1.19.html">v1.19: 1.19.5 (June 9, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.18/v1.18.html">v1.18: 1.18.6 (February 22, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.17/v1.17.html">v1.17: 1.17.4 (August 24, 2021)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.16/v1.16.html">v1.16: 1.16.5 (August 24, 2021)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.15/v1.15.html">v1.15: 1.15.5 (May 11, 2021)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.14/v1.14.html">v1.14: 1.14.7 (April 15, 2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.13/v1.13.html">v1.13: 1.13.8 (January 15, 2021)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.12/v1.12.html">v1.12: 1.12.7 (September 29, 2020)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.11/v1.11.html">v1.11: 1.11.2 (October 8, 2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.10/v1.10.html">v1.10: 1.10.0 (April 5, 2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.9/v1.9.html">v1.9: 1.9.1 (April 2, 2019)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.8/v1.8.html">v1.8: 1.8.0 (October 4, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.7/v1.7.html">v1.7: 1.7.1 (August 3, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.6/v1.6.html">v1.6: 1.6.0 (March 20, 2018)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.5/v1.5.html">v1.5: 1.5.0 (December 4, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.4/v1.4.html">v1.4: 1.4.0 (August 24, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.3/v1.3.html">v1.3: 1.3.0 (May 17, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.2/v1.2.html">v1.2: 1.2.0 (March 7, 2017)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.1/v1.1.html">v1.1: 1.1.0 (November 30, 2016)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../v1.0/v1.0.html">v1.0: 1.0.0 (September 12, 2016)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../version_history.html#deprecation-policy">Deprecation Policy</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../version_history.html">Version history</a></li>
          <li class="breadcrumb-item"><a href="v1.22.html">v1.22</a></li>
      <li class="breadcrumb-item active">1.22.0 (April 15, 2022)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/version_history/v1.22/v1.22.0.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="april-15-2022">
<span id="version-history-1-22-0"></span><h1>1.22.0 (April 15, 2022)<a class="headerlink" href="#april-15-2022" title="Link to this heading"></a></h1>
<section id="incompatible-behavior-changes">
<h2>Incompatible behavior changes<a class="headerlink" href="#incompatible-behavior-changes" title="Link to this heading"></a></h2>
<p><em>Changes that are expected to cause an incompatibility if applicable; deployment changes are likely required</em></p>
<ul class="simple">
<li><p><strong>sip-proxy</strong>: change API by replacing <code class="docutils literal notranslate"><span class="pre">own_domain</span></code> with <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/sip_proxy/v3alpha/sip_proxy.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-v3alpha-localservice" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">local_services</span></a>.</p></li>
<li><p><strong>tls</strong>: set TLS v1.2 as the default minimal version for servers. Users can still explicitly opt-in to 1.0 and 1.1 using
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/transport_sockets/tls/v3/common.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-tlsparameters-tls-minimum-protocol-version" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">tls_minimum_protocol_version</span></a>.</p></li>
</ul>
</section>
<section id="minor-behavior-changes">
<h2>Minor behavior changes<a class="headerlink" href="#minor-behavior-changes" title="Link to this heading"></a></h2>
<p><em>Changes that may cause incompatibilities for some users, but should not for most</em></p>
<ul class="simple">
<li><p><strong>access_log</strong>: log all header values in the grpc access log.</p></li>
<li><p><strong>build</strong>: <code class="docutils literal notranslate"><span class="pre">VERSION</span></code> and <code class="docutils literal notranslate"><span class="pre">API_VERSION</span></code> have been renamed to <code class="docutils literal notranslate"><span class="pre">VERSION.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">API_VERSION.txt</span></code> respectively to avoid
conflicts with the C++ <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code> header.</p></li>
<li><p><strong>config</strong>: type URL is used to lookup extensions regardless of the name field. This may cause problems for empty filter
configurations or mis-matched protobuf as the typed configurations. This behavioral change can be temporarily reverted
by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.no_extension_lookup_by_name</span></code> to false.</p></li>
<li><p><strong>config</strong>: warning messages for protobuf unknown fields now contain ancestors for easier troubleshooting.</p></li>
<li><p><strong>cryptomb</strong>: remove RSA PKCS1 v1.5 padding support.</p></li>
<li><p><strong>decompressor</strong>: decompressor does not duplicate <code class="docutils literal notranslate"><span class="pre">accept-encoding</span></code> header values anymore. This behavioral change can be reverted by
setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.append_to_accept_content_encoding_only_once</span></code> to false.</p></li>
<li><p><strong>dynamic_forward_proxy</strong>: if a DNS resolution fails, failing immediately with a specific resolution error, rather than finishing up all local
filters and failing to select an upstream host.</p></li>
<li><p><strong>ecds</strong>: changed to use <code class="docutils literal notranslate"><span class="pre">http_filter</span></code> stat prefix as the metrics root for ECDS subscriptions. This behavior can be temporarily
reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.top_level_ecds_stats</span></code> to false.</p></li>
<li><p><strong>ext_authz</strong>: added requested server name in ext_authz network filter for auth review.</p></li>
<li><p><strong>ext_authz</strong>: forward <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/base.proto.html#envoy-v3-api-field-config-core-v3-metadata-typed-filter-metadata" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">typed_filter_metadata</span></a> selected by
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto.html#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-extauthz-typed-metadata-context-namespaces" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">typed_metadata_context_namespaces</span></a> to external auth
service.</p></li>
<li><p><strong>file</strong>: changed disk based files to truncate files which are not being appended to. This behavioral change can be temporarily
reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.append_or_truncate</span></code> to false.</p></li>
<li><p><strong>grpc</strong>: flip runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.enable_grpc_async_client_cache</span></code> to be default enabled. async grpc client
created through <code class="docutils literal notranslate"><span class="pre">getOrCreateRawAsyncClient</span></code> will be cached by default.</p></li>
<li><p><strong>health_checker</strong>: exposing <code class="docutils literal notranslate"><span class="pre">initial_metadata</span></code> to GrpcHealthCheck in a way similar to <code class="docutils literal notranslate"><span class="pre">request_headers_to_add</span></code> of HttpHealthCheck.</p></li>
<li><p><strong>http</strong>: added the ability to have multiple URI type Subject Alternative Names of the client certificate in the
<a class="reference internal" href="../../configuration/http/http_conn_man/headers.html#config-http-conn-man-headers-x-forwarded-client-cert"><span class="std std-ref">x-forwarded-client-cert</span></a> header.</p></li>
<li><p><strong>http</strong>: avoiding delay-close for HTTP/1.0 responses framed by <code class="docutils literal notranslate"><span class="pre">connection:</span> <span class="pre">close</span></code> as well as HTTP/1.1 if the request is fully
read. This means for responses to such requests, the FIN will be sent immediately after the response. This behavior can
be temporarily reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.skip_delay_close</span></code> to false.  If clients are seen to be
receiving sporadic partial responses and flipping this flag fixes it, please notify the project immediately.</p></li>
<li><p><strong>http</strong>: changed the http status code to 504 from 408 if the request times out after the request is completed. This behavior can
be temporarily reverted by setting the runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.override_request_timeout_by_gateway_timeout</span></code> to false.</p></li>
<li><p><strong>http</strong>: lazy disable downstream connection reading in the HTTP/1 codec to reduce unnecessary system calls. This behavioral
change can be temporarily reverted by setting runtime guard <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http1_lazy_read_disable</span></code> to
false.</p></li>
<li><p><strong>http</strong>: now the max concurrent streams of http2 connection can not only be adjusted down according to the SETTINGS frame but
also can be adjusted up. Of course, it can not exceed the configured upper bounds. This fix is guarded by
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_allow_capacity_increase_by_settings</span></code>.</p></li>
<li><p><strong>http</strong>: respecting <code class="docutils literal notranslate"><span class="pre">content-type</span></code> in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-responsemapper-headers-to-add" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">headers_to_add</span></a> even when the
response body is modified. This behavioral change can be temporarily reverted by setting runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_adding_content_type_in_local_replies</span></code> to false.</p></li>
<li><p><strong>http</strong>: when writing custom filters, <code class="docutils literal notranslate"><span class="pre">injectEncodedDataToFilterChain</span></code> and <code class="docutils literal notranslate"><span class="pre">injectDecodedDataToFilterChain</span></code> now trigger
sending of headers if they were not yet sent due to <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>. Previously, calling one of the inject functions
in that state would trigger an assertion. See issue #19891 for more details.</p></li>
<li><p><strong>listener</strong>: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/address.proto.html#envoy-v3-api-field-config-core-v3-socketaddress-ipv4-compat" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">ipv4_compat</span></a> flag can only be set on Ipv6
address and Ipv4-mapped Ipv6 address. A runtime guard is added <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.strict_check_on_ipv4_compat</span></code>
and the default is true.</p></li>
<li><p><strong>network</strong>: add a new ConnectionEvent <code class="docutils literal notranslate"><span class="pre">ConnectedZeroRtt</span></code> which may be raised by QUIC connections to allow early data to be sent
before the handshake finishes. This event is ignored at callsites which is only reachable for TCP connections in the
Envoy core code. Any extensions which depend on ConnectionEvent enum value should audit their usage of it to make sure
this new event is handled appropriately.</p></li>
<li><p><strong>oauth2</strong>: disable chunked transfer encoding in the token request to be compatible with Azure AD (login.microsoftonline.com).</p></li>
<li><p><strong>perf</strong>: tls contexts are now tracked without scan based garbage collection greatly improving the performance on secret update.</p></li>
<li><p><strong>ratelimit</strong>: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-msg-config-route-v3-ratelimit-action-headervaluematch" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">header_value_match</span></a> config now supports
custom descriptor keys.</p></li>
<li><p><strong>router</strong>: record upstream request timeouts for all cases and not just for those requests which are awaiting headers. This
behavioral change can be temporarily reverted by setting runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.do_not_await_headers_on_upstream_timeout_to_emit_stats</span></code> to false.</p></li>
<li><p><strong>runtime</strong>: deprecated runtime flags set via configuration files or xDS will now ENVOY_BUG, rather than silently resulting in
unexpected behavior on the data plane by no longer applying removed code paths.</p></li>
<li><p><strong>runtime</strong>: removed global runtime as Envoy default. This behavioral change can be reverted by setting runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.restart_features.no_runtime_singleton</span></code> to false.</p></li>
<li><p><strong>sip-proxy</strong>: add customized affinity support by adding <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/sip_proxy/tra/v3alpha/tra.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-tra-v3alpha-traserviceconfig" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">tra_service_config</span></a> and <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/sip_proxy/v3alpha/sip_proxy.proto.html#envoy-v3-api-msg-extensions-filters-network-sip-proxy-v3alpha-customizedaffinity" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">customized_affinity</span></a>.</p></li>
<li><p><strong>sip-proxy</strong>: add support for the <code class="docutils literal notranslate"><span class="pre">503</span></code> response code. When there is something wrong occurred, send <code class="docutils literal notranslate"><span class="pre">503</span> <span class="pre">Service</span> <span class="pre">Unavailable</span></code> back
to downstream.</p></li>
<li><p><strong>stateful session http filter</strong>: only enable cookie based session state when request path matches the configured cookie path.</p></li>
<li><p><strong>tracing</strong>: set tracing error tag for grpc non-ok response code only when it is a upstream error. Client error will not be tagged as
a grpc error. This fix is guarded by <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.update_grpc_response_error_tag</span></code>.</p></li>
</ul>
</section>
<section id="bug-fixes">
<h2>Bug fixes<a class="headerlink" href="#bug-fixes" title="Link to this heading"></a></h2>
<p><em>Changes expected to improve the state of the world and are unlikely to have negative effects</em></p>
<ul class="simple">
<li><p><strong>access_log</strong>: fix memory leak when reopening an access log fails. Access logs will now try to be reopened on each subsequent flush
attempt after a failure.</p></li>
<li><p><strong>data plane</strong>: fix crash when internal redirect selects a route configured with direct response or redirect actions.</p></li>
<li><p><strong>data plane</strong>: fix error handling where writing to a socket failed while under the stack of processing. This should only effect HTTP/3.
This behavioral change can be reverted by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_upstream_inline_write</span></code> to false.</p></li>
<li><p><strong>eds</strong>: fix the eds cluster update by allowing update on the locality of the cluster endpoints. This behavioral change can be
temporarily reverted by setting runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.support_locality_update_on_eds_cluster_endpoints</span></code> to false.</p></li>
<li><p><strong>hot restart</strong>: fixed a bug where an incorrect fd was passed to child when a tcp listener and a udp listener listen to the same address
because socket type was not used to find the matching listener for a url.</p></li>
<li><p><strong>http</strong>: fixed a bug where <code class="docutils literal notranslate"><span class="pre">%RESPONSE_CODE_DETAILS%</span></code> was not set correctly in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route.proto.html#envoy-v3-api-field-config-route-v3-routeconfiguration-request-headers-to-add" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">request_headers_to_add</span></a>.</p></li>
<li><p><strong>http</strong>: fixed a bug where <code class="docutils literal notranslate"><span class="pre">100-continue</span></code> comparison in the <code class="docutils literal notranslate"><span class="pre">Expect</span></code> request header field was case sensitive. This RFC
compliant behavior can be temporarily reverted by setting runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_100_continue_case_insensitive</span></code> to false.</p></li>
<li><p><strong>jwt_authn</strong>: fixed a bug where a JWT with empty “iss” is passed even the field <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/http/jwt_authn/v3/config.proto.html#envoy-v3-api-field-extensions-filters-http-jwt-authn-v3-jwtprovider-issuer" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">issuer</span></a> is specified. If the “issuer” field is
specified, “iss” in the JWT should match it.</p></li>
<li><p><strong>jwt_authn</strong>: fixed the crash when a CONNECT request is sent to JWT filter configured with regex match on the Host header.</p></li>
<li><p><strong>router</strong>: fixed mirror policy <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-runtime-fraction" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">runtime_fraction</span></a> to correctly allow reading from a
fractional percent value stored in runtime in all cases. Previously it would only do this if the default numerator was
above 0, otherwise it would use the integer variant with a default of 0. The default of 0 is retained, but runtime
lookup will happen in all cases and recognize a stored fractional percent.</p></li>
<li><p><strong>tcp_proxy</strong>: fix a crash that occurs when configured for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-tunneling-config" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">upstream tunneling</span></a> and the downstream connection
disconnects while the the upstream connection or http/2 stream is still being established.</p></li>
<li><p><strong>tls</strong>: fix a bug while matching a certificate SAN with an exact value in <code class="docutils literal notranslate"><span class="pre">match_typed_subject_alt_names</span></code> of a listener where
wildcard <code class="docutils literal notranslate"><span class="pre">*</span></code> character is not the only character of the dns label. Example, <code class="docutils literal notranslate"><span class="pre">baz*.example.net</span></code> and
<code class="docutils literal notranslate"><span class="pre">*baz.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">b*z.example.net</span></code> will match <code class="docutils literal notranslate"><span class="pre">baz1.example.net</span></code> and <code class="docutils literal notranslate"><span class="pre">foobaz.example.net</span></code> and
<code class="docutils literal notranslate"><span class="pre">buzz.example.net</span></code>, respectively.</p></li>
<li><p><strong>upstream</strong>: added cluster slow start config <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-slowstartconfig-min-weight-percent" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">min_weight_percent</span></a> field to avoid too big EDF deadline
which cause slow start endpoints receiving no traffic, default 10%. This fix is related to <a class="reference external" href="https://github.com/envoyproxy/envoy/issues/19526">issue #19526</a>.</p></li>
<li><p><strong>upstream</strong>: fix stack overflow when a cluster with large number of idle connections is removed.</p></li>
<li><p><strong>xds</strong>: fix a crash that occurs when Envoy receives a discovery response without <code class="docutils literal notranslate"><span class="pre">control_plane</span></code> field.</p></li>
<li><p><strong>xds</strong>: fix the wildcard resource versions that are sent upon reconnection when using delta-xds mode.</p></li>
<li><p><strong>xray</strong>: fix the AWS X-Ray tracer extension to annotate a child span with <code class="docutils literal notranslate"><span class="pre">type=subsegment</span></code> to correctly relate subsegments to
a parent segment. Previously a subsegment would be treated as an independent segment.</p></li>
<li><p><strong>xray</strong>: fix the AWS X-Ray tracer extension to not sample the trace if <code class="docutils literal notranslate"><span class="pre">sampled=</span></code> keyword is not present in the header
<code class="docutils literal notranslate"><span class="pre">x-amzn-trace-id</span></code>.</p></li>
<li><p><strong>xray</strong>: fix the AWS X-Ray tracer extension to reuse the trace ID already present in the header <code class="docutils literal notranslate"><span class="pre">x-amzn-trace-id</span></code> instead of
creating a new one.</p></li>
<li><p><strong>xray</strong>: fix the AWS X-Ray tracer extension to set the HTTP <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header value as <code class="docutils literal notranslate"><span class="pre">client_ip</span></code> in the segment
data.</p></li>
</ul>
</section>
<section id="removed-config-or-runtime">
<h2>Removed config or runtime<a class="headerlink" href="#removed-config-or-runtime" title="Link to this heading"></a></h2>
<p><em>Normally occurs at the end of the</em> <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/version_history/version_history.html#deprecated" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">deprecation period</span></a></p>
<ul class="simple">
<li><p><strong>access_log</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.unquote_log_string_values</span></code> and legacy code paths.</p></li>
<li><p><strong>grpc_bridge_filter</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.grpc_bridge_stats_disabled</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.allow_response_for_timeout</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.hash_multiple_header_values</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_consume_stream_refused_errors</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http_transport_failure_reason_in_body</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.internal_redirects_with_body</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.no_chunked_encoding_header_for_304</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.preserve_downstream_scheme</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.require_strict_1xx_and_204_response_headers</span></code> and
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.send_strict_1xx_and_204_response_headers</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.strip_port_from_connect</span></code> and legacy code paths.</p></li>
<li><p><strong>http</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_observable_cluster_name</span></code> and legacy code paths.</p></li>
<li><p><strong>json</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.remove_legacy_json</span></code> and legacy code paths.</p></li>
<li><p><strong>listener</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.listener_reuse_port_default_enabled</span></code> and legacy code paths.</p></li>
<li><p><strong>listener</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.listener_wildcard_match_ip_family</span></code> and legacy code paths.</p></li>
<li><p><strong>udp</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.udp_per_event_loop_read_limit</span></code> and legacy code paths.</p></li>
<li><p><strong>upstream</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.health_check.graceful_goaway_handling</span></code> and legacy code paths.</p></li>
<li><p><strong>xds</strong>: removed <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.vhds_heartbeats</span></code> and legacy code paths.</p></li>
</ul>
</section>
<section id="new-features">
<h2>New features<a class="headerlink" href="#new-features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>access_log</strong>: added TCP proxy upstream and downstream byte logging. This can be accessed through the <code class="docutils literal notranslate"><span class="pre">%DOWNSTREAM_WIRE_BYTES_SENT%</span></code>,
<code class="docutils literal notranslate"><span class="pre">%DOWNSTREAM_WIRE_BYTES_RECEIVED%</span></code>, <code class="docutils literal notranslate"><span class="pre">%UPSTREAM_WIRE_BYTES_SENT%</span></code>, and <code class="docutils literal notranslate"><span class="pre">%UPSTREAM_WIRE_BYTES_RECEIVED%</span></code> access_log
command operatrors.</p></li>
<li><p><strong>access_log</strong>: added new access_log command operator <code class="docutils literal notranslate"><span class="pre">%ENVIRONMENT(X):Z%</span></code>.</p></li>
<li><p><strong>access_log</strong>: added new access_log command operator <code class="docutils literal notranslate"><span class="pre">%GRPC_STATUS_NUMBER%</span></code>.</p></li>
<li><p><strong>access_log</strong>: make consistent access_log format fields <code class="docutils literal notranslate"><span class="pre">%(DOWN|DIRECT_DOWN|UP)STREAM_(LOCAL|REMOTE)_*%</span></code> to provide all combinations
of local &amp; remote addresses for upstream &amp; downstream connections.</p></li>
<li><p><strong>admin</strong>: <a class="reference internal" href="../../operations/admin.html#post--logging" title="POST /logging"><code class="xref http http-post docutils literal notranslate"><span class="pre">POST</span> <span class="pre">/logging</span></code></a> now accepts <code class="docutils literal notranslate"><span class="pre">/logging?paths=name1:level1,name2:level2,...</span></code> to change multiple log levels at
once.</p></li>
<li><p><strong>cluster</strong>: added support for per host limits in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/circuit_breaker.proto.html#envoy-v3-api-msg-config-cluster-v3-circuitbreakers" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">circuit breakers settings</span></a>. Currently only <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/circuit_breaker.proto.html#envoy-v3-api-field-config-cluster-v3-circuitbreakers-thresholds-max-connections" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">max_connections</span></a> is supported.</p></li>
<li><p><strong>cluster</strong>: added support to restore original destination address from any desired header via setting <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-originaldstlbconfig-http-header-name" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">http_header_name</span></a>.</p></li>
<li><p><strong>cluster</strong>: support <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/cluster.proto.html#envoy-v3-api-field-config-cluster-v3-cluster-commonlbconfig-override-host-status" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">override host status restriction</span></a>.</p></li>
<li><p><strong>compression</strong>: add zstd <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/compression/zstd/compressor/v3/zstd.proto.html#envoy-v3-api-msg-extensions-compression-zstd-compressor-v3-zstd" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">compressor</span></a> and <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/compression/zstd/decompressor/v3/zstd.proto.html#envoy-v3-api-msg-extensions-compression-zstd-decompressor-v3-zstd" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">decompressor</span></a>.</p></li>
<li><p><strong>config</strong>: added new <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/configuration/operations/config_validation/config_validation.html#config-config-validation" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">custom config validators</span></a> to dynamically verify config updates.</p></li>
<li><p><strong>config</strong>: added new file based xDS configuration via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path-config-source" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">path_config_source</span></a>. <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-pathconfigsource-watched-directory" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">watched_directory</span></a> can be used to setup an independent watch for
when to reload the file path, for example when using Kubernetes ConfigMaps to deliver configuration. See the linked
documentation for more information.</p></li>
<li><p><strong>cors</strong>: add dynamic support for headers <code class="docutils literal notranslate"><span class="pre">access-control-allow-methods</span></code> and <code class="docutils literal notranslate"><span class="pre">access-control-allow-headers</span></code> in cors.</p></li>
<li><p><strong>dns</strong>: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/common/dynamic_forward_proxy/v3/dns_cache.proto.html#envoy-v3-api-field-extensions-common-dynamic-forward-proxy-v3-dnscacheconfig-dns-min-refresh-rate" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">dns_min_refresh_rate</span></a> to the DNS cache
implementation to configure the minimum DNS refresh rate, regardless of returned TTL. This was previously hard coded to
5s and defaults to 5s if unset.</p></li>
<li><p><strong>gcp authentication http filter</strong>: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/configuration/http/http_filters/gcp_authn_filter.html#config-http-filters-gcp-authn" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">gcp authentication http filter</span></a>.</p></li>
<li><p><strong>http</strong>: added <code class="docutils literal notranslate"><span class="pre">random_value_specifier</span></code> in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-weighted-clusters" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">weighted_clusters</span></a> to allow random value to be specified from
configuration proto.</p></li>
<li><p><strong>http</strong>: added <code class="docutils literal notranslate"><span class="pre">request_mirror_policies</span></code> to higher levels (i.e., <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route.proto.html#envoy-v3-api-field-config-route-v3-routeconfiguration-request-mirror-policies" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">request_mirror_policies</span></a> in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route.proto.html#envoy-v3-api-msg-config-route-v3-routeconfiguration" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">RouteConfiguration</span></a> and <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-virtualhost-request-mirror-policies" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">request_mirror_policies</span></a> in <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-msg-config-route-v3-virtualhost" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">VirtualHost</span></a>) which applies to <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routeaction-request-mirror-policies" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">request_mirror_policies</span></a> in all routes underneath without configured
mirror policies.</p></li>
<li><p><strong>http</strong>: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-internaladdressconfig-cidr-ranges" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">cidr_ranges</span></a>
for configuring list of CIDR ranges that are considered internal.</p></li>
<li><p><strong>http</strong>: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-proxy-status-config" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">proxy_status_config</span></a>
for configuring <a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-proxy-status-08">Proxy-Status</a> HTTP response
header fields.</p></li>
<li><p><strong>http</strong>: make consistent custom header format fields <code class="docutils literal notranslate"><span class="pre">%(DOWN|DIRECT_DOWN|UP)STREAM_(LOCAL|REMOTE)_*%</span></code> to provide all
combinations of local &amp; remote addresses for upstream &amp; downstream connections.</p></li>
<li><p><strong>http2</strong>: adds the new runtime feature <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_use_oghttp2</span></code>, disabled by default, that guards use of a
new HTTP/2 implementation.</p></li>
<li><p><strong>http2</strong>: re-enabled the HTTP/2 wrapper API. This should be a transparent change that does not affect functionality. Any behavior
changes can be reverted by setting the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.http2_new_codec_wrapper</span></code> runtime feature to false.</p></li>
<li><p><strong>http3</strong>: add <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/transport_sockets/quic/v3/quic_transport.proto.html#envoy-v3-api-field-extensions-transport-sockets-quic-v3-quicdownstreamtransport-enable-early-data" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">enable_early_data</span></a> to turn on/off
downstream early data support.</p></li>
<li><p><strong>http3</strong>: downstream HTTP/3 support is now GA! Upstream HTTP/3 also GA for specific deployments. See <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/intro/arch_overview/http/http3.html#arch-overview-http3" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">here</span></a> for details.</p></li>
<li><p><strong>http3</strong>: supports upstream HTTP/3 retries. Automatically retry <a class="reference external" href="https://www.rfc-editor.org/rfc/rfc7231#section-4.2.1">0-RTT safe requests</a> if they are rejected because they are sent <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc8470#section-5.2">too early</a>. And automatically retry 0-RTT safe requests if connect
attempt fails later on and the cluster is configured with TCP fallback. And add retry on <code class="docutils literal notranslate"><span class="pre">http3-post-connect-failure</span></code>
policy which allows retry of failed HTTP/3 requests with TCP fallback even after handshake if the cluster is configured
with TCP fallback. This feature is guarded by
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.conn_pool_new_stream_with_early_data_and_http3</span></code>.</p></li>
<li><p><strong>listener</strong>: implement <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/intro/arch_overview/advanced/matching/matching_listener.html#arch-overview-matching-listener" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">matching API</span></a> for selecting filter chains.</p></li>
<li><p><strong>local_ratelimit</strong>: added support for <code class="docutils literal notranslate"><span class="pre">X-RateLimit-*</span></code> headers as defined in <a class="reference external" href="https://tools.ietf.org/id/draft-polli-ratelimit-headers-03.html">draft RFC</a>.</p></li>
<li><p><strong>local_ratelimit</strong>: added support for sharing the rate limiter between multiple network filter chains or listeners via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/local_ratelimit/v3/local_rate_limit.proto.html#envoy-v3-api-field-extensions-filters-network-local-ratelimit-v3-localratelimit-share-key" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">share_key</span></a>.</p></li>
<li><p><strong>matching</strong>: the matching API can now express a match tree that will always match by omitting a matcher at the top level.</p></li>
<li><p><strong>outlier_detection</strong>: <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/cluster/v3/outlier_detection.proto.html#envoy-v3-api-field-config-cluster-v3-outlierdetection-base-ejection-time" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">max_ejection_time_jitter</span></a> configuration
added to allow adding a random value to the ejection time to prevent ‘thundering herd’ scenarios. Defaults to 0 so as to
not break or change the behavior of existing deployments.</p></li>
<li><p><strong>ratelimit</strong>: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/http/ratelimit/v3/rate_limit.proto.html#envoy-v3-api-field-extensions-filters-http-ratelimit-v3-ratelimit-rate-limited-status" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">rate_limited_status</span></a>
to support return a custom HTTP response status code to the downstream client when the request has been rate limited.</p></li>
<li><p><strong>ratelimit</strong>: network rate limiter supports runtime value substitution using stream info and substitution formatting via <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/configuration/listeners/network_filters/rate_limit_filter.html#config-network-filters-ratelimit-substitution-formatter" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">Network
Rate Limiter</span></a>.</p></li>
<li><p><strong>redis</strong>: support for hostnames returned in <code class="docutils literal notranslate"><span class="pre">cluster_slots</span></code> response is now available.</p></li>
<li><p><strong>router</strong>: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-routematch-path-separated-prefix" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">path_separated_prefix</span></a> to make route
creation more efficient.</p></li>
<li><p><strong>schema_validator_tool</strong>: added <code class="docutils literal notranslate"><span class="pre">--fail-on-deprecated</span></code> and <code class="docutils literal notranslate"><span class="pre">--fail-on-wip</span></code> to the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">schema validator check tool</span></a> to allow failing the check if either deprecated or work-in-progress fields
are used.</p></li>
<li><p><strong>schema_validator_tool</strong>: added <code class="docutils literal notranslate"><span class="pre">bootstrap</span></code> checking to the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">schema validator check tool</span></a>.</p></li>
<li><p><strong>schema_validator_tool</strong>: fixed linking of all extensions into the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">schema validator check tool</span></a>
so that all typed configurations can be properly verified.</p></li>
<li><p><strong>schema_validator_tool</strong>: the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">schema validator check tool</span></a> will now recurse into all sub
messages, including Any messages, and perform full validation (deprecation, work-in-progress, PGV, etc.). Previously
only top-level messages were fully validated.</p></li>
<li><p><strong>stats</strong>: histogram_buckets query parameter added to stats endpoint to change histogram output to show buckets.</p></li>
<li><p><strong>tap</strong>: added support for buffering an arbitrary number of tapped traces before returning to the client via a new <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/tap/v3/common.proto.html#envoy-v3-api-field-config-tap-v3-outputsink-buffered-admin" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">buffered
admin sink</span></a>.</p></li>
<li><p><strong>tcp_proxy</strong>: added support for on demand cluster. If the <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto.html#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-on-demand" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">on_demand</span></a> is set and the destination cluster is
not present, a delta CDS request will be sent and the tcp proxy flow will be resumed after that cds response.</p></li>
<li><p><strong>thrift</strong>: add support for connection draining. This can be enabled by setting the runtime guard
<code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.thrift_connection_draining</span></code> to true.</p></li>
<li><p><strong>thrift</strong>: added support for dynamic routing through aggregated discovery service.</p></li>
<li><p><strong>tls</strong>: add support for tls key log <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/transport_sockets/tls/v3/tls.proto.html#envoy-v3-api-field-extensions-transport-sockets-tls-v3-commontlscontext-key-log" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">key_log</span></a>.</p></li>
<li><p><strong>tools</strong>: the project now ships a <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/start/install.html#install-tools" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">tools docker image</span></a> which contains tools useful in support systems such as
CI, CD, etc. The <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/operations/tools/schema_validator_check_tool.html#install-tools-schema-validator-check-tool" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">schema validator check tool</span></a> has been added to the
tools image.</p></li>
<li><p><strong>udp_proxy</strong>: added <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-matcher" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">matcher</span></a> to support matching
and routing to different clusters.</p></li>
<li><p><strong>udp_proxy</strong>: added support for <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-access-log" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">access_log</span></a>.</p></li>
</ul>
</section>
<section id="deprecated">
<h2>Deprecated<a class="headerlink" href="#deprecated" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong>config</strong>: deprecated <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">path</span></a> in favor of <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/config/core/v3/config_source.proto.html#envoy-v3-api-field-config-core-v3-configsource-path-config-source" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">path_config_source</span></a>.</p></li>
<li><p><strong>http</strong>: deprecated <code class="docutils literal notranslate"><span class="pre">envoy.http.headermap.lazy_map_min_size</span></code>.  If you are using this config knob you can revert this
temporarily by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.deprecate_global_ints</span></code> to true but you MUST file an upstream issue
to ensure this feature remains available.</p></li>
<li><p><strong>http</strong>: removing support for long-deprecated old style filter names, e.g. envoy.router, envoy.lua.</p></li>
<li><p><strong>re2</strong>: removed undocumented histograms <code class="docutils literal notranslate"><span class="pre">re2.program_size</span></code> and <code class="docutils literal notranslate"><span class="pre">re2.exceeded_warn_level</span></code>.</p></li>
<li><p><strong>thrift</strong>: deprecated TTwitter protocol since we believe it’s not used and it’s causing significant maintenance burden.</p></li>
<li><p><strong>udp_proxy</strong>: deprecated <a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-cluster" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">cluster</span></a> in favor of
<a class="reference external" href="https://www.envoyproxy.io/docs/envoy/v1.22.11/api-v3/extensions/filters/udp/udp_proxy/v3/udp_proxy.proto.html#envoy-v3-api-field-extensions-filters-udp-udp-proxy-v3-udpproxyconfig-matcher" title="(in envoy vtag-v1.22.11)"><span class="xref std std-ref">matcher</span></a>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="v1.22.1.html" class="btn btn-neutral float-left" title="1.22.1 (June 9, 2022)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../v1.21/v1.21.html" class="btn btn-neutral float-right" title="v1.21" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>