<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Golang &mdash; envoy tag-v1.30.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d7d10ef0" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/envoy.css?v=3ec0219e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4da122e5" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=d350ee53"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=db7b0edf"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="gRPC Field Extraction" href="grpc_field_extraction_filter.html" />
    <link rel="prev" title="IP Geolocation Filter" href="geoip_filter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                tag-v1.30.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../http.html">HTTP</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../http_conn_man/http_conn_man.html">HTTP connection manager</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="http_filters.html">HTTP filters</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="adaptive_concurrency_filter.html">Adaptive Concurrency</a></li>
<li class="toctree-l4"><a class="reference internal" href="admission_control_filter.html">Admission Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="aws_lambda_filter.html">AWS Lambda</a></li>
<li class="toctree-l4"><a class="reference internal" href="aws_request_signing_filter.html">AWS Request Signing</a></li>
<li class="toctree-l4"><a class="reference internal" href="bandwidth_limit_filter.html">Bandwidth limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="basic_auth_filter.html">Basic Auth</a></li>
<li class="toctree-l4"><a class="reference internal" href="buffer_filter.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="cache_filter.html">Cache filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="cdn_loop_filter.html">CDN-Loop header</a></li>
<li class="toctree-l4"><a class="reference internal" href="checksum_filter.html">Checksum</a></li>
<li class="toctree-l4"><a class="reference internal" href="compressor_filter.html">Compressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="composite_filter.html">Composite Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="connect_grpc_bridge_filter.html">Connect-gRPC Bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="cors_filter.html">CORS</a></li>
<li class="toctree-l4"><a class="reference internal" href="credential_injector_filter.html">Credential Injector</a></li>
<li class="toctree-l4"><a class="reference internal" href="csrf_filter.html">CSRF</a></li>
<li class="toctree-l4"><a class="reference internal" href="custom_response_filter.html">Custom Response Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="decompressor_filter.html">Decompressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamic_forward_proxy_filter.html">Dynamic forward proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamodb_filter.html">DynamoDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_authz_filter.html">External Authorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_proc_filter.html">External Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="fault_filter.html">Fault Injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="file_system_buffer_filter.html">File System Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcp_authn_filter.html">GCP Authentication Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="geoip_filter.html">IP Geolocation Filter</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Golang</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_field_extraction_filter.html">gRPC Field Extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_bridge_filter.html">gRPC HTTP/1.1 bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_reverse_bridge_filter.html">gRPC HTTP/1.1 reverse bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_json_transcoder_filter.html">gRPC-JSON transcoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_stats_filter.html">gRPC Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_web_filter.html">gRPC-Web</a></li>
<li class="toctree-l4"><a class="reference internal" href="header_mutation_filter.html">Header Mutation</a></li>
<li class="toctree-l4"><a class="reference internal" href="health_check_filter.html">Health check</a></li>
<li class="toctree-l4"><a class="reference internal" href="header_to_metadata_filter.html">Envoy Header-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="ip_tagging_filter.html">IP Tagging</a></li>
<li class="toctree-l4"><a class="reference internal" href="json_to_metadata_filter.html">Envoy Json-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="jwt_authn_filter.html">JWT Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="kill_request_filter.html">Kill Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="language_filter.html">Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="local_rate_limit_filter.html">Local rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="lua_filter.html">Lua</a></li>
<li class="toctree-l4"><a class="reference internal" href="oauth2_filter.html">OAuth2</a></li>
<li class="toctree-l4"><a class="reference internal" href="on_demand_updates_filter.html">On-demand VHDS, S/RDS and CDS Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="original_src_filter.html">Original Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limit_filter.html">Rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limit_quota_filter.html">Rate Limit Quota (Work-In-Progress)</a></li>
<li class="toctree-l4"><a class="reference internal" href="rbac_filter.html">Role Based Access Control (RBAC) Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="router_filter.html">Router</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_filter_state.html">Set-Filter-State HTTP Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_metadata_filter.html">Set Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="squash_filter.html">Squash</a></li>
<li class="toctree-l4"><a class="reference internal" href="stateful_session_filter.html">Stateful session</a></li>
<li class="toctree-l4"><a class="reference internal" href="sxg_filter.html">SXG</a></li>
<li class="toctree-l4"><a class="reference internal" href="tap_filter.html">Tap</a></li>
<li class="toctree-l4"><a class="reference internal" href="upstream_codec_filter.html">Upstream Codec</a></li>
<li class="toctree-l4"><a class="reference internal" href="wasm_filter.html">Wasm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../caches/caches.html">HTTP caches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster_specifier/cluster_specifier.html">HTTP cluster specifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../observability/observability.html">Observability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/operations.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_features/other_features.html">Other features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_protocols/other_protocols.html">Other protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/best_practices.html">Configuration best practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../configuration.html">Configuration reference</a></li>
          <li class="breadcrumb-item"><a href="../http.html">HTTP</a></li>
          <li class="breadcrumb-item"><a href="http_filters.html">HTTP filters</a></li>
      <li class="breadcrumb-item active">Golang</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/configuration/http/http_filters/golang_filter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="golang">
<span id="config-http-filters-golang"></span><h1>Golang<a class="headerlink" href="#golang" title="Permalink to this heading"></a></h1>
<p>The HTTP Golang filter allows <a class="reference external" href="https://go.dev/">Golang</a> to be run during both the request
and response flows and makes it easier to extend Envoy.</p>
<p>Go plugins used by this filter can be recompiled independently of Envoy.</p>
<p>See the <a class="reference external" href="https://docs.google.com/document/d/1noApyS0IfmOGmEOHdWk2-BOp0V37zgXMM4MdByr1lQk/edit?usp=sharing">Envoy’s Golang extension proposal documentation</a>
for more details on the filter’s implementation.</p>
<section id="developing-a-go-plugin">
<h2>Developing a Go plugin<a class="headerlink" href="#developing-a-go-plugin" title="Permalink to this heading"></a></h2>
<p>Envoy’s Go plugins must implement the <a class="reference external" href="https://github.com/envoyproxy/envoy/blob/v1.30.5/contrib/golang/common/go/api/filter.go">StreamFilter API</a>.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The Go plugin API is not yet stable, you are <strong>strongly</strong> recommended to use the same version of Go plugin SDK and Envoy.</p>
</div>
<p>When you are using a release version of Envoy, i.e. 1.26.x,
you should use <code class="docutils literal notranslate"><span class="pre">github.com/envoyproxy/envoy</span> <span class="pre">v1.26.x</span></code> in the go.mod file.</p>
<p>When you are not using a release, i.e. the latest main branch of Envoy,
you could use <code class="docutils literal notranslate"><span class="pre">go</span> <span class="pre">get</span> <span class="pre">-u</span> <span class="pre">github.com/envoyproxy/envoy&#64;SHA</span></code> to get the same version of Go plugin SDK,
the SHA is the latest commit sha.</p>
</section>
<section id="building-a-go-plugin">
<h2>Building a Go plugin<a class="headerlink" href="#building-a-go-plugin" title="Permalink to this heading"></a></h2>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>When building a Go plugin dynamic library, you <strong>must</strong> use a Go version consistent
with Envoy’s version of glibc.</p>
</div>
<p>One way to ensure a compatible Go version is to use the Go binary provided by Envoy’s bazel setup:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bazel<span class="w"> </span>run<span class="w"> </span>@go_sdk//:bin/go<span class="w"> </span>--<span class="w"> </span>version
<span class="go">...</span>
<span class="go">go version goX.YZ linux/amd64</span>
</pre></div>
</div>
<p>For example, to build the <code class="docutils literal notranslate"><span class="pre">.so</span></code> for a <code class="docutils literal notranslate"><span class="pre">foo</span></code> plugin, you might run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bazel<span class="w"> </span>run<span class="w"> </span>@go_sdk//:bin/go<span class="w"> </span>build<span class="w"> </span>--<span class="w"> </span>--buildmode<span class="o">=</span>c-shared<span class="w">  </span>-v<span class="w"> </span>-o<span class="w"> </span>path/to/output/libfoo.so<span class="w"> </span>path/to/src/foo
</pre></div>
</div>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This filter should be configured with the type URL
<a class="reference internal" href="../../../api-v3/extensions/filters/http/golang/v3alpha/golang.proto.html#envoy-v3-api-msg-extensions-filters-http-golang-v3alpha-config"><span class="std std-ref">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span></a>.</p>
</div>
<p>A prebuilt Golang HTTP filter  <code class="docutils literal notranslate"><span class="pre">my_plugin.so</span></code> might be configured as follows:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/eccd41ec3ed6f4d75cbc386564f38f3d/golang.yaml"><code class="xref download docutils literal notranslate"><span class="pre">golang.yaml</span></code></a></span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="w">          </span><span class="nt">http_filters</span><span class="p">:</span>
<span class="hll"><span class="linenos">17</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
</span><span class="hll"><span class="linenos">18</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">19</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
</span><span class="hll"><span class="linenos">20</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-plugin-id</span>
</span><span class="hll"><span class="linenos">21</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_plugin.so&quot;</span>
</span><span class="hll"><span class="linenos">22</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_plugin</span>
</span><span class="linenos">23</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.header_to_metadata</span>
</pre></div>
</div>
</div>
<p>An <a class="reference internal" href="../../../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-msg-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager"><span class="std std-ref">HttpConnectionManager</span></a> can
have multiple Go plugins in its <a class="reference internal" href="../../../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-http-filters"><span class="std std-ref">http_filters</span></a>:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/eccd41ec3ed6f4d75cbc386564f38f3d/golang.yaml"><code class="xref download docutils literal notranslate"><span class="pre">golang.yaml</span></code></a></span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="w">          </span><span class="nt">http_filters</span><span class="p">:</span>
<span class="hll"><span class="linenos">17</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
</span><span class="hll"><span class="linenos">18</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">19</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
</span><span class="hll"><span class="linenos">20</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-plugin-id</span>
</span><span class="hll"><span class="linenos">21</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_plugin.so&quot;</span>
</span><span class="hll"><span class="linenos">22</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_plugin</span>
</span><span class="linenos">23</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.header_to_metadata</span>
<span class="hll"><span class="linenos">24</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">25</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.header_to_metadata.v3.Config</span>
</span><span class="hll"><span class="linenos">26</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
</span><span class="hll"><span class="linenos">27</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">28</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
</span><span class="hll"><span class="linenos">29</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-other-plugin-id</span>
</span><span class="linenos">30</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_other_plugin.so&quot;</span>
<span class="linenos">31</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_other_plugin</span>
<span class="linenos">32</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.router</span>
<span class="linenos">33</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</pre></div>
</div>
</div>
<p>This can be useful if, for example, you have one plugin that provides authentication, and another
that provides connection limiting.</p>
</section>
<section id="extensible-plugin-configuration">
<h2>Extensible plugin configuration<a class="headerlink" href="#extensible-plugin-configuration" title="Permalink to this heading"></a></h2>
<p>Envoy’s Go plugins can specify and use their own configuration.</p>
<p>Below is a very simple example of how such a plugin might be configured in Envoy:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/a36b4f1275423abe9c685529c18aefa3/golang-with-config.yaml"><code class="xref download docutils literal notranslate"><span class="pre">golang-with-config.yaml</span></code></a></span><a class="headerlink" href="#id4" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">17</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
<span class="linenos">18</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
<span class="linenos">20</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-configurable-plugin-id</span>
<span class="linenos">21</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_configurable_plugin.so&quot;</span>
<span class="linenos">22</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_configurable_plugin</span>
<span class="hll"><span class="linenos">23</span><span class="w">              </span><span class="nt">plugin_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">24</span><span class="w">                </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/xds.type.v3.TypedStruct</span>
</span><span class="hll"><span class="linenos">25</span><span class="w">                </span><span class="nt">value</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">26</span><span class="w">                  </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bar</span>
</span><span class="linenos">27</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.router</span>
</pre></div>
</div>
</div>
<p>See the <a class="reference external" href="https://github.com/envoyproxy/envoy/blob/v1.30.5/contrib/golang/common/go/api/filter.go">StreamFilter API</a>
for more information about how the plugin’s configuration data can be accessed.</p>
<section id="per-route-plugin-configuration">
<h3>Per-route plugin configuration<a class="headerlink" href="#per-route-plugin-configuration" title="Permalink to this heading"></a></h3>
<p>Go plugins can be configured on a
<a class="reference internal" href="../../../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-route-typed-per-filter-config"><span class="std std-ref">per-route</span></a> basis, as in the example below:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/02f6e0970a9e8e8ff7b68fe90fc9073e/golang-with-per-route-config.yaml"><code class="xref download docutils literal notranslate"><span class="pre">golang-with-per-route-config.yaml</span></code></a></span><a class="headerlink" href="#id5" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">16</span><span class="w">          </span><span class="nt">http_filters</span><span class="p">:</span>
<span class="hll"><span class="linenos">17</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
</span><span class="hll"><span class="linenos">18</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">19</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
</span><span class="hll"><span class="linenos">20</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-configurable-plugin-id</span>
</span><span class="hll"><span class="linenos">21</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_configurable_plugin.so&quot;</span>
</span><span class="hll"><span class="linenos">22</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_configurable_plugin</span>
</span><span class="linenos">23</span><span class="w">              </span><span class="nt">plugin_config</span><span class="p">:</span>
<span class="linenos">24</span><span class="w">                </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/xds.type.v3.TypedStruct</span>
<span class="linenos">25</span><span class="w">                </span><span class="nt">value</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">                  </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_foo</span>
<span class="linenos">27</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.router</span>
<span class="linenos">28</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.router.v3.Router</span>
<span class="linenos">30</span><span class="w">          </span><span class="nt">route_config</span><span class="p">:</span>
<span class="linenos">31</span><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">route_0</span>
<span class="linenos">32</span><span class="w">            </span><span class="nt">virtual_hosts</span><span class="p">:</span>
<span class="linenos">33</span><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service_0</span>
<span class="linenos">34</span><span class="w">              </span><span class="nt">domains</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;*&quot;</span><span class="p p-Indicator">]</span>
<span class="linenos">35</span><span class="w">              </span><span class="nt">routes</span><span class="p">:</span>
<span class="hll"><span class="linenos">36</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">match</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">37</span><span class="w">                  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
</span><span class="hll"><span class="linenos">38</span><span class="w">                </span><span class="nt">route</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">39</span><span class="w">                  </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster_0</span>
</span><span class="hll"><span class="linenos">40</span><span class="w">            </span><span class="nt">typed_per_filter_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">41</span><span class="w">              </span><span class="nt">envoy.filters.http.golang</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">42</span><span class="w">                </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.ConfigsPerRoute</span>
</span><span class="hll"><span class="linenos">43</span><span class="w">                </span><span class="nt">plugins_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">44</span><span class="w">                  </span><span class="nt">my_configurable_plugin</span><span class="p">:</span>
</span></pre></div>
</div>
</div>
</section>
<section id="per-virtualhost-plugin-configuration">
<h3>Per-virtualhost plugin configuration<a class="headerlink" href="#per-virtualhost-plugin-configuration" title="Permalink to this heading"></a></h3>
<p>Go plugins can also be configured on a
<a class="reference internal" href="../../../api-v3/config/route/v3/route_components.proto.html#envoy-v3-api-field-config-route-v3-virtualhost-typed-per-filter-config"><span class="std std-ref">per-virtualhost</span></a>  basis:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/7291d78853fda0c29dede69d7d06aa5a/golang-with-per-virtualhost-config.yaml"><code class="xref download docutils literal notranslate"><span class="pre">golang-with-per-virtualhost-config.yaml</span></code></a></span><a class="headerlink" href="#id6" title="Permalink to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w">          </span><span class="nt">http_filters</span><span class="p">:</span>
<span class="hll"><span class="linenos"> 2</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.golang</span>
</span><span class="hll"><span class="linenos"> 3</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos"> 4</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.Config</span>
</span><span class="hll"><span class="linenos"> 5</span><span class="w">              </span><span class="nt">library_id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-configurable-plugin-id</span>
</span><span class="hll"><span class="linenos"> 6</span><span class="w">              </span><span class="nt">library_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;lib/my_configurable_plugin.so&quot;</span>
</span><span class="hll"><span class="linenos"> 7</span><span class="w">              </span><span class="nt">plugin_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_configurable_plugin</span>
</span><span class="linenos"> 8</span><span class="w">              </span><span class="nt">plugin_config</span><span class="p">:</span>
<span class="linenos"> 9</span><span class="w">                </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/xds.type.v3.TypedStruct</span>
<span class="linenos">10</span><span class="w">                </span><span class="nt">value</span><span class="p">:</span>
<span class="linenos">11</span><span class="w">                  </span><span class="nt">foo</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_foo</span>
<span class="linenos">12</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.router</span>
<span class="linenos">13</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">14</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.router.v3.Router</span>
<span class="linenos">15</span><span class="w">          </span><span class="nt">route_config</span><span class="p">:</span>
<span class="linenos">16</span><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">route_0</span>
<span class="linenos">17</span><span class="w">            </span><span class="nt">virtual_hosts</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">service_0</span>
<span class="linenos">19</span><span class="w">              </span><span class="nt">domains</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;*&quot;</span><span class="p p-Indicator">]</span>
<span class="linenos">20</span><span class="w">              </span><span class="nt">routes</span><span class="p">:</span>
<span class="hll"><span class="linenos">21</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">match</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">22</span><span class="w">                  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
</span><span class="hll"><span class="linenos">23</span><span class="w">                </span><span class="nt">route</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">24</span><span class="w">                  </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cluster_0</span>
</span><span class="hll"><span class="linenos">25</span><span class="w">                </span><span class="nt">typed_per_filter_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">26</span><span class="w">                  </span><span class="nt">envoy.filters.http.golang</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">27</span><span class="w">                    </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.golang.v3alpha.ConfigsPerRoute</span>
</span><span class="hll"><span class="linenos">28</span><span class="w">                    </span><span class="nt">plugins_config</span><span class="p">:</span>
</span><span class="hll"><span class="linenos">29</span><span class="w">                      </span><span class="nt">my_configurable_plugin</span><span class="p">:</span>
</span></pre></div>
</div>
</div>
</section>
</section>
<section id="complete-example">
<h2>Complete example<a class="headerlink" href="#complete-example" title="Permalink to this heading"></a></h2>
<p>Learn more about building and running a plugin for the Envoy Go filter in the step by step <a class="reference internal" href="../../../start/sandboxes/golang-http.html#install-sandboxes-golang-http"><span class="std std-ref">Envoy Go Sandbox</span></a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="geoip_filter.html" class="btn btn-neutral float-left" title="IP Geolocation Filter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="grpc_field_extraction_filter.html" class="btn btn-neutral float-right" title="gRPC Field Extraction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2024, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>