

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wasm (proto) &mdash; envoy tag-v1.34.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=d7d10ef0" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/envoy.css?v=3ec0219e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css?v=4da122e5" />

  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=6e1bbc49"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../../_static/copybutton.js?v=db7b0edf"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Listeners" href="../../../listeners/listeners.html" />
    <link rel="prev" title="VCL socket interface configuration (proto)" href="../../vcl/v3alpha/vcl_socket_interface.proto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../configuration/configuration.html">Configuration reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../api/api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../../api/api_supported_versions.html">Supported API versions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../api.html">v3 API reference</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../bootstrap/bootstrap.html">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../clusters/clusters.html">Clusters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../http_routes/http_routes.html">HTTP route management</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../../config/config.html">Extensions</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../config/accesslog/filters.html">Access log extension filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/formatter/formatter.html">Access log formatters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/accesslog/accesslog.html">Access loggers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/cluster/cluster.html">Cluster</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/common/common.html">Common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/compression/compression.html">Compression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/config_validators/config_validators.html">Config validators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/contrib/contrib.html">Contrib extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/dns_resolver/dns_resolver.html">DNS resolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/endpoint/endpoint.html">Endpoint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/filter/filter.html">Filters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/grpc_credential/grpc_credential.html">Grpc credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/health_check_event_sinks/health_check_event_sinks.html">Health check event sinks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/health_checker/health_checker.html">Health checkers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/early_header_mutation.html">HTTP early header mutation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/custom_response.html">Custom response policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/ext_proc.html">External Processing Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/header_formatters.html">HTTP header formatters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/header_validators.html">HTTP header validators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/original_ip_detection.html">HTTP original IP detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/http/stateful_session.html">HTTP stateful session</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/injected_credentials/injected_credentials.html">Injected credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/geoip_provider/geoip_provider.html">Geolocation providers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/trace/trace.html">HTTP tracers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/internal_redirect/internal_redirect.html">Internal redirect predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/path/match/path_matcher.html">Path matcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/path/rewrite/path_rewriter.html">Path rewriter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/quic/quic_extensions.html">Quic extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/descriptors/descriptors.html">Rate limit descriptors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/rbac/rbac.html">RBAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/rbac/matchers.html">RBAC matchers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/rbac/matchers.html#rbac-principals">RBAC principals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/request_id/request_id.html">Request ID</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/resource_monitor/resource_monitor.html">Resource monitors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/retry/retry.html">Retry predicates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/stat_sinks/stat_sinks.html">Stat sinks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/string_matcher/string_matcher.html">String Matcher</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/transport_socket/transport_socket.html">Transport sockets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/upstream/upstream.html">Upstream configuration</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../../config/wasm/wasm.html">WASM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/watchdog/watchdog.html">Watchdog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/load_balancing_policies/load_balancing_policies.html">Load balancing policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/cluster_specifier/cluster_specifier.html">Cluster specifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../admin/admin.html">Admin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../data/data.html">Envoy data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../service/service.html">Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../common_messages/common_messages.html">Common messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../common_messages/common_messages_xds.html">Common messages (XDS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../types/types.html">Types</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api-docs/xds_protocol.html">xDS REST and gRPC protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/client_features.html">Well Known Client Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../version_history/version_history.html">Version history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../api/api.html">API</a></li>
          <li class="breadcrumb-item"><a href="../../../api.html">v3 API reference</a></li>
          <li class="breadcrumb-item"><a href="../../../bootstrap/bootstrap.html">Bootstrap</a></li>
      <li class="breadcrumb-item active">Wasm (proto)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/api-v3/extensions/wasm/v3/wasm.proto.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wasm-proto">
<span id="envoy-v3-api-file-envoy-extensions-wasm-v3-wasm-proto"></span><h1>Wasm (proto)<a class="headerlink" href="#wasm-proto" title="Link to this heading"></a></h1>
<p id="extension-envoy-bootstrap-wasm">This extension has the qualified name <code class="docutils literal notranslate"><span class="pre">envoy.bootstrap.wasm</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This extension is functional but has not had substantial production burn time,
use only with this caveat.</p>
<p>This extension has an unknown security posture and should only be
used in deployments where both the downstream and upstream are
trusted.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This extension extends and can be used with the following extension category:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../config/bootstrap/v3/bootstrap.proto.html#extension-category-envoy-bootstrap"><span class="std std-ref">envoy.bootstrap</span></a></p></li>
</ul>
<p>This extension must be configured with one of the following type URLs:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-wasmservice"><span class="std std-ref">type.googleapis.com/envoy.extensions.wasm.v3.WasmService</span></a></p></li>
</ul>
</div>
<section id="extensions-wasm-v3-reloadconfig">
<span id="envoy-v3-api-msg-extensions-wasm-v3-reloadconfig"></span><h2>extensions.wasm.v3.ReloadConfig<a class="headerlink" href="#extensions-wasm-v3-reloadconfig" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L42">[extensions.wasm.v3.ReloadConfig proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;backoff&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-reloadconfig-backoff">
<dt>backoff</dt><dd><p>(<a class="reference internal" href="../../../config/core/v3/backoff.proto.html#envoy-v3-api-msg-config-core-v3-backoffstrategy"><span class="std std-ref">config.core.v3.BackoffStrategy</span></a>) Backoff strategy for the VM failure reload. If not specified, the default 1s base interval
will be applied.</p>
</dd>
</dl>
</section>
<section id="extensions-wasm-v3-capabilityrestrictionconfig">
<span id="envoy-v3-api-msg-extensions-wasm-v3-capabilityrestrictionconfig"></span><h2>extensions.wasm.v3.CapabilityRestrictionConfig<a class="headerlink" href="#extensions-wasm-v3-capabilityrestrictionconfig" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L49">[extensions.wasm.v3.CapabilityRestrictionConfig proto]</a></p>
<p>Configuration for restricting Proxy-Wasm capabilities available to modules.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;allowed_capabilities&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl id="envoy-v3-api-field-extensions-wasm-v3-capabilityrestrictionconfig-allowed-capabilities">
<dt>allowed_capabilities</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-sanitizationconfig"><span class="std std-ref">extensions.wasm.v3.SanitizationConfig</span></a>&gt;) The Proxy-Wasm capabilities which will be allowed. Capabilities are mapped by
name. The <code class="docutils literal notranslate"><span class="pre">SanitizationConfig</span></code> which each capability maps to is currently unimplemented and ignored,
and so should be left empty.</p>
<p>The capability names are given in the
<a class="reference external" href="https://github.com/proxy-wasm/spec/tree/master/abi-versions/vNEXT">Proxy-Wasm ABI</a>.
Additionally, the following WASI capabilities from
<a class="reference external" href="https://github.com/WebAssembly/WASI/blob/master/phases/snapshot/docs.md#modules">this list</a>
are implemented and can be allowed:
<code class="docutils literal notranslate"><span class="pre">fd_write</span></code>, <code class="docutils literal notranslate"><span class="pre">fd_read</span></code>, <code class="docutils literal notranslate"><span class="pre">fd_seek</span></code>, <code class="docutils literal notranslate"><span class="pre">fd_close</span></code>, <code class="docutils literal notranslate"><span class="pre">fd_fdstat_get</span></code>, <code class="docutils literal notranslate"><span class="pre">environ_get</span></code>, <code class="docutils literal notranslate"><span class="pre">environ_sizes_get</span></code>,
<code class="docutils literal notranslate"><span class="pre">args_get</span></code>, <code class="docutils literal notranslate"><span class="pre">args_sizes_get</span></code>, <code class="docutils literal notranslate"><span class="pre">proc_exit</span></code>, <code class="docutils literal notranslate"><span class="pre">clock_time_get</span></code>, <code class="docutils literal notranslate"><span class="pre">random_get</span></code>.</p>
</dd>
</dl>
</section>
<section id="extensions-wasm-v3-sanitizationconfig">
<span id="envoy-v3-api-msg-extensions-wasm-v3-sanitizationconfig"></span><h2>extensions.wasm.v3.SanitizationConfig<a class="headerlink" href="#extensions-wasm-v3-sanitizationconfig" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L67">[extensions.wasm.v3.SanitizationConfig proto]</a></p>
<p>Configuration for sanitization of inputs to an allowed capability.</p>
<p>NOTE: This is currently unimplemented.</p>
</section>
<section id="extensions-wasm-v3-vmconfig">
<span id="envoy-v3-api-msg-extensions-wasm-v3-vmconfig"></span><h2>extensions.wasm.v3.VmConfig<a class="headerlink" href="#extensions-wasm-v3-vmconfig" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L72">[extensions.wasm.v3.VmConfig proto]</a></p>
<p>Configuration for a Wasm VM.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;vm_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;runtime&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;code&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;configuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;allow_precompiled&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;nack_on_code_cache_miss&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;environment_variables&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-vm-id">
<dt>vm_id</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) An ID which will be used along with a hash of the wasm code (or the name of the registered Null
VM plugin) to determine which VM will be used for the plugin. All plugins which use the same
<code class="docutils literal notranslate"><span class="pre">vm_id</span></code> and code will use the same VM. May be left blank. Sharing a VM between plugins can
reduce memory utilization and make sharing of data easier which may have security implications.</p>
</dd>
</dl>
<dl id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-runtime">
<dt>runtime</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The Wasm runtime type, defaults to the first available Wasm engine used at Envoy build-time.
The priority to search for the available engine is: v8 -&gt; wasmtime -&gt; wamr.
Available Wasm runtime types are registered as extensions. The following runtimes are included
in Envoy code base:</p>
<p id="extension-envoy-wasm-runtime-null"><strong>envoy.wasm.runtime.null</strong>: Null sandbox, the Wasm module must be compiled and linked into the
Envoy binary. The registered name is given in the <code class="docutils literal notranslate"><span class="pre">code</span></code> field as <code class="docutils literal notranslate"><span class="pre">inline_string</span></code>.</p>
<p id="extension-envoy-wasm-runtime-v8"><strong>envoy.wasm.runtime.v8</strong>: <a class="reference external" href="https://v8.dev/">V8</a>-based WebAssembly runtime.</p>
<p id="extension-envoy-wasm-runtime-wamr"><strong>envoy.wasm.runtime.wamr</strong>: <a class="reference external" href="https://github.com/bytecodealliance/wasm-micro-runtime/">WAMR</a>-based WebAssembly runtime.
This runtime is not enabled in the official build.</p>
<p id="extension-envoy-wasm-runtime-wasmtime"><strong>envoy.wasm.runtime.wasmtime</strong>: <a class="reference external" href="https://wasmtime.dev/">Wasmtime</a>-based WebAssembly runtime.
This runtime is not enabled in the official build.</p>
<div class="admonition tip" id="extension-category-envoy-wasm-runtime">
<p class="admonition-title">Tip</p>
<p>This extension category has the following known extensions:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#extension-envoy-wasm-runtime-null"><span class="std std-ref">envoy.wasm.runtime.null</span></a></p></li>
<li><p><a class="reference internal" href="#extension-envoy-wasm-runtime-v8"><span class="std std-ref">envoy.wasm.runtime.v8</span></a></p></li>
<li><p><a class="reference internal" href="#extension-envoy-wasm-runtime-wamr"><span class="std std-ref">envoy.wasm.runtime.wamr</span></a></p></li>
<li><p><a class="reference internal" href="#extension-envoy-wasm-runtime-wasmtime"><span class="std std-ref">envoy.wasm.runtime.wasmtime</span></a></p></li>
</ul>
</div>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-code">
<dt>code</dt><dd><p>(<a class="reference internal" href="../../../config/core/v3/base.proto.html#envoy-v3-api-msg-config-core-v3-asyncdatasource"><span class="std std-ref">config.core.v3.AsyncDataSource</span></a>) The Wasm code that Envoy will execute.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-configuration">
<dt>configuration</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>) The Wasm configuration used in initialization of a new VM
(proxy_on_start). <code class="docutils literal notranslate"><span class="pre">google.protobuf.Struct</span></code> is serialized as JSON before
passing it to the plugin. <code class="docutils literal notranslate"><span class="pre">google.protobuf.BytesValue</span></code> and
<code class="docutils literal notranslate"><span class="pre">google.protobuf.StringValue</span></code> are passed directly without the wrapper.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-allow-precompiled">
<dt>allow_precompiled</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) Allow the wasm file to include pre-compiled code on VMs which support it.
Warning: this should only be enable for trusted sources as the precompiled code is not
verified.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-nack-on-code-cache-miss">
<dt>nack_on_code_cache_miss</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If true and the code needs to be remotely fetched and it is not in the cache then NACK the configuration
update and do a background fetch to fill the cache, otherwise fetch the code asynchronously and enter
warming state.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-vmconfig-environment-variables">
<dt>environment_variables</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-environmentvariables"><span class="std std-ref">extensions.wasm.v3.EnvironmentVariables</span></a>) Specifies environment variables to be injected to this VM which will be available through
WASI’s <code class="docutils literal notranslate"><span class="pre">environ_get</span></code> and <code class="docutils literal notranslate"><span class="pre">environ_get_sizes</span></code> system calls. Note that these functions
are generally called implicitly by your language’s standard library. Therefore, you do not
need to call them directly. You can access environment variables in the same way you would
on native platforms.
Warning: Envoy rejects the configuration if there’s conflict of key space.</p>
</dd>
</dl>
</section>
<section id="extensions-wasm-v3-environmentvariables">
<span id="envoy-v3-api-msg-extensions-wasm-v3-environmentvariables"></span><h2>extensions.wasm.v3.EnvironmentVariables<a class="headerlink" href="#extensions-wasm-v3-environmentvariables" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L135">[extensions.wasm.v3.EnvironmentVariables proto]</a></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;host_env_keys&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">  </span><span class="nt">&quot;key_values&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-environmentvariables-host-env-keys">
<dt>host_env_keys</dt><dd><p>(<strong>repeated</strong> <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) The keys of <em>Envoy’s</em> environment variables exposed to this VM. In other words, if a key exists in Envoy’s environment
variables, then that key-value pair will be injected. Note that if a key does not exist, it will be ignored.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-environmentvariables-key-values">
<dt>key_values</dt><dd><p>(<strong>repeated</strong> map&lt;<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>, <a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>&gt;) Explicitly given key-value pairs to be injected to this VM in the form of “KEY=VALUE”.</p>
</dd>
</dl>
</section>
<section id="extensions-wasm-v3-pluginconfig">
<span id="envoy-v3-api-msg-extensions-wasm-v3-pluginconfig"></span><h2>extensions.wasm.v3.PluginConfig<a class="headerlink" href="#extensions-wasm-v3-pluginconfig" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L146">[extensions.wasm.v3.PluginConfig proto]</a></p>
<p>Base Configuration for Wasm Plugins e.g. filters and services.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;root_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;vm_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;configuration&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;fail_open&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;failure_policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;reload_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;capability_restriction_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-name">
<dt>name</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) A unique name for a filters/services in a VM for use in identifying the filter/service if
multiple filters/services are handled by the same <code class="docutils literal notranslate"><span class="pre">vm_id</span></code> and <code class="docutils literal notranslate"><span class="pre">root_id</span></code> and for
logging/debugging.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-root-id">
<dt>root_id</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">string</a>) A unique ID for a set of filters/services in a VM which will share a RootContext and Contexts
if applicable (e.g. an Wasm HttpFilter and an Wasm AccessLog). If left blank, all
filters/services with a blank root_id with the same <code class="docutils literal notranslate"><span class="pre">vm_id</span></code> will share Context(s).</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-vm-config">
<dt>vm_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-vmconfig"><span class="std std-ref">extensions.wasm.v3.VmConfig</span></a>)
Configuration for finding or starting VM.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-configuration">
<dt>configuration</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/reference/google.protobuf#any">Any</a>) Filter/service configuration used to configure or reconfigure a plugin
(<code class="docutils literal notranslate"><span class="pre">proxy_on_configure</span></code>).
<code class="docutils literal notranslate"><span class="pre">google.protobuf.Struct</span></code> is serialized as JSON before
passing it to the plugin. <code class="docutils literal notranslate"><span class="pre">google.protobuf.BytesValue</span></code> and
<code class="docutils literal notranslate"><span class="pre">google.protobuf.StringValue</span></code> are passed directly without the wrapper.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-fail-open">
<dt>fail_open</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If there is a fatal error on the VM (e.g. exception, abort(), on_start or on_configure return false),
then all plugins associated with the VM will either fail closed (by default), e.g. by returning an HTTP 503 error,
or fail open (if ‘fail_open’ is set to true) by bypassing the filter. Note: when on_start or on_configure return false
during xDS updates the xDS configuration will be rejected and when on_start or on_configuration return false on initial
startup the proxy will not start.
This field is deprecated in favor of the <code class="docutils literal notranslate"><span class="pre">failure_policy</span></code> field.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-failure-policy">
<dt>failure_policy</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-enum-extensions-wasm-v3-failurepolicy"><span class="std std-ref">extensions.wasm.v3.FailurePolicy</span></a>) The failure policy for the plugin.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-reload-config">
<dt>reload_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-reloadconfig"><span class="std std-ref">extensions.wasm.v3.ReloadConfig</span></a>) Reload configuration. This is only applied when <code class="docutils literal notranslate"><span class="pre">failure_policy</span></code> is set to <code class="docutils literal notranslate"><span class="pre">FAIL_RELOAD</span></code>.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-pluginconfig-capability-restriction-config">
<dt>capability_restriction_config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-capabilityrestrictionconfig"><span class="std std-ref">extensions.wasm.v3.CapabilityRestrictionConfig</span></a>) Configuration for restricting Proxy-Wasm capabilities available to modules.</p>
</dd>
</dl>
</section>
<section id="extensions-wasm-v3-wasmservice">
<span id="envoy-v3-api-msg-extensions-wasm-v3-wasmservice"></span><h2>extensions.wasm.v3.WasmService<a class="headerlink" href="#extensions-wasm-v3-wasmservice" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L190">[extensions.wasm.v3.WasmService proto]</a></p>
<p>WasmService is configured as a built-in <code class="docutils literal notranslate"><span class="pre">envoy.wasm_service</span></code> <a class="reference internal" href="../../../../configuration/other_features/wasm_service.html#config-wasm-service"><span class="std std-ref">WasmService</span></a> This opaque configuration will be used to create a Wasm Service.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="err">...</span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;singleton&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">...</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-wasmservice-config">
<dt>config</dt><dd><p>(<a class="reference internal" href="#envoy-v3-api-msg-extensions-wasm-v3-pluginconfig"><span class="std std-ref">extensions.wasm.v3.PluginConfig</span></a>) General plugin configuration.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-field-extensions-wasm-v3-wasmservice-singleton">
<dt>singleton</dt><dd><p>(<a class="reference external" href="https://developers.google.com/protocol-buffers/docs/proto#scalar">bool</a>) If true, create a single VM rather than creating one VM per worker. Such a singleton can
not be used with filters.</p>
</dd>
</dl>
</section>
<section id="enum-extensions-wasm-v3-failurepolicy">
<span id="envoy-v3-api-enum-extensions-wasm-v3-failurepolicy"></span><h2>Enum extensions.wasm.v3.FailurePolicy<a class="headerlink" href="#enum-extensions-wasm-v3-failurepolicy" title="Link to this heading"></a></h2>
<p><a class="extlink-repo reference external" href="https://github.com/envoyproxy/envoy/blob/v1.34.8/api/envoy/extensions/wasm/v3/wasm.proto#L22">[extensions.wasm.v3.FailurePolicy proto]</a></p>
<p>If there is a fatal error on the VM (e.g. exception, abort()), then the policy will be applied.</p>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-wasm-v3-failurepolicy-unspecified">
<dt>UNSPECIFIED</dt><dd><p><em>(DEFAULT)</em> ⁣No policy is specified. The default policy will be used. The default policy is <code class="docutils literal notranslate"><span class="pre">FAIL_CLOSED</span></code>.</p>
</dd>
</dl>
<dl id="envoy-v3-api-enum-value-extensions-wasm-v3-failurepolicy-fail-reload">
<dt>FAIL_RELOAD</dt><dd><p>⁣New plugin instance will be created for the new request if the VM is failed. Note this only
be applied to the following failures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">proxy_wasm::FailState::RuntimeError</span></code></p></li>
</ul>
<p>This will fallback to the <code class="docutils literal notranslate"><span class="pre">FAIL_CLOSED</span></code> for all other failures.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-wasm-v3-failurepolicy-fail-closed">
<dt>FAIL_CLOSED</dt><dd><p>⁣All plugins associated with the VM will return an HTTP 503 error.</p>
</dd>
</dl>
<dl class="simple" id="envoy-v3-api-enum-value-extensions-wasm-v3-failurepolicy-fail-open">
<dt>FAIL_OPEN</dt><dd><p>⁣All plugins associated with the VM will be ignored and the filter chain will continue. This
makes sense when the plugin is optional.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../vcl/v3alpha/vcl_socket_interface.proto.html" class="btn btn-neutral float-left" title="VCL socket interface configuration (proto)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../../listeners/listeners.html" class="btn btn-neutral float-right" title="Listeners" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>