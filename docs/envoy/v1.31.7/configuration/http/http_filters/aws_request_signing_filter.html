<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AWS Request Signing &mdash; envoy tag-v1.31.7 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d7d10ef0" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/envoy.css?v=3ec0219e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4da122e5" />

  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=ebf07af7"></script>
        <script src="../../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=db7b0edf"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Bandwidth limit" href="bandwidth_limit_filter.html" />
    <link rel="prev" title="AWS Lambda" href="aws_lambda_filter.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/envoy-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                tag-v1.31.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../http.html">HTTP</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../http_conn_man/http_conn_man.html">HTTP connection manager</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="http_filters.html">HTTP filters</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="adaptive_concurrency_filter.html">Adaptive Concurrency</a></li>
<li class="toctree-l4"><a class="reference internal" href="admission_control_filter.html">Admission Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="aws_lambda_filter.html">AWS Lambda</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">AWS Request Signing</a></li>
<li class="toctree-l4"><a class="reference internal" href="bandwidth_limit_filter.html">Bandwidth limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="basic_auth_filter.html">Basic Auth</a></li>
<li class="toctree-l4"><a class="reference internal" href="buffer_filter.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="cache_filter.html">Cache filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="cdn_loop_filter.html">CDN-Loop header</a></li>
<li class="toctree-l4"><a class="reference internal" href="checksum_filter.html">Checksum</a></li>
<li class="toctree-l4"><a class="reference internal" href="compressor_filter.html">Compressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="composite_filter.html">Composite Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="connect_grpc_bridge_filter.html">Connect-gRPC Bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="cors_filter.html">CORS</a></li>
<li class="toctree-l4"><a class="reference internal" href="credential_injector_filter.html">Credential injector</a></li>
<li class="toctree-l4"><a class="reference internal" href="csrf_filter.html">CSRF</a></li>
<li class="toctree-l4"><a class="reference internal" href="custom_response_filter.html">Custom Response Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="decompressor_filter.html">Decompressor</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamic_forward_proxy_filter.html">Dynamic forward proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="dynamodb_filter.html">DynamoDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_authz_filter.html">External Authorization</a></li>
<li class="toctree-l4"><a class="reference internal" href="ext_proc_filter.html">External Processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="fault_filter.html">Fault Injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="file_system_buffer_filter.html">File System Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="gcp_authn_filter.html">GCP Authentication Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="geoip_filter.html">IP Geolocation Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="golang_filter.html">Golang</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_field_extraction_filter.html">gRPC Field Extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_bridge_filter.html">gRPC HTTP/1.1 bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_http1_reverse_bridge_filter.html">gRPC HTTP/1.1 reverse bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_json_transcoder_filter.html">gRPC-JSON transcoder</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_stats_filter.html">gRPC Statistics</a></li>
<li class="toctree-l4"><a class="reference internal" href="grpc_web_filter.html">gRPC-Web</a></li>
<li class="toctree-l4"><a class="reference internal" href="header_mutation_filter.html">Header Mutation</a></li>
<li class="toctree-l4"><a class="reference internal" href="health_check_filter.html">Health check</a></li>
<li class="toctree-l4"><a class="reference internal" href="header_to_metadata_filter.html">Envoy Header-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="ip_tagging_filter.html">IP Tagging</a></li>
<li class="toctree-l4"><a class="reference internal" href="json_to_metadata_filter.html">Envoy Json-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="jwt_authn_filter.html">JWT Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="kill_request_filter.html">Kill Request</a></li>
<li class="toctree-l4"><a class="reference internal" href="language_filter.html">Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="local_rate_limit_filter.html">Local rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="lua_filter.html">Lua</a></li>
<li class="toctree-l4"><a class="reference internal" href="oauth2_filter.html">OAuth2</a></li>
<li class="toctree-l4"><a class="reference internal" href="on_demand_updates_filter.html">On-demand VHDS, S/RDS and CDS Updates</a></li>
<li class="toctree-l4"><a class="reference internal" href="original_src_filter.html">Original Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limit_filter.html">Rate limit</a></li>
<li class="toctree-l4"><a class="reference internal" href="rate_limit_quota_filter.html">Rate Limit Quota (Work-In-Progress)</a></li>
<li class="toctree-l4"><a class="reference internal" href="rbac_filter.html">Role Based Access Control (RBAC) Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="router_filter.html">Router</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_filter_state.html">Set-Filter-State HTTP Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="set_metadata_filter.html">Set Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="squash_filter.html">Squash</a></li>
<li class="toctree-l4"><a class="reference internal" href="stateful_session_filter.html">Stateful session</a></li>
<li class="toctree-l4"><a class="reference internal" href="sxg_filter.html">SXG</a></li>
<li class="toctree-l4"><a class="reference internal" href="tap_filter.html">Tap</a></li>
<li class="toctree-l4"><a class="reference internal" href="thrift_to_metadata_filter.html">Envoy Thrift-To-Metadata Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="upstream_codec_filter.html">Upstream Codec</a></li>
<li class="toctree-l4"><a class="reference internal" href="wasm_filter.html">Wasm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../caches/caches.html">HTTP caches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cluster_specifier/cluster_specifier.html">HTTP cluster specifier</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../upstream/upstream.html">Upstream clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../observability/observability.html">Observability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/security.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/operations.html">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_features/other_features.html">Other features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../other_protocols/other_protocols.html">Other protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../advanced/advanced.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../best_practices/best_practices.html">Configuration best practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extending/extending.html">Extending Envoy for custom use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq/overview.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../version_history/version_history.html">Version history</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">envoy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../configuration.html">Configuration reference</a></li>
          <li class="breadcrumb-item"><a href="../http.html">HTTP</a></li>
          <li class="breadcrumb-item"><a href="http_filters.html">HTTP filters</a></li>
      <li class="breadcrumb-item active">AWS Request Signing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/configuration/http/http_filters/aws_request_signing_filter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="aws-request-signing">
<span id="config-http-filters-aws-request-signing"></span><h1>AWS Request Signing<a class="headerlink" href="#aws-request-signing" title="Link to this heading"></a></h1>
<ul class="simple">
<li><p>This filter should be configured with the type URL <code class="docutils literal notranslate"><span class="pre">type.googleapis.com/envoy.extensions.filters.http.aws_request_signing.v3.AwsRequestSigning</span></code>.</p></li>
<li><p><a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-msg-extensions-filters-http-aws-request-signing-v3-awsrequestsigning"><span class="std std-ref">v3 API reference</span></a></p></li>
</ul>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The AWS request signing filter is experimental and is currently under active development.</p>
</div>
<p>The HTTP AWS request signing filter is used to access authenticated AWS services. It uses the
existing AWS Credential Provider to get the secrets used for generating the required
headers.</p>
<p>This filter can be used to communicate with both AWS API endpoints and customer API endpoints, such as AWS API Gateway
hosted APIs or Amazon VPC Lattice services.</p>
<p>The <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-use-unsigned-payload"><span class="std std-ref">use_unsigned_payload</span></a>
option determines whether or not requests are buffered so the request body can be used to compute the payload hash. Some
services, such as S3, allow requests with unsigned payloads. Consult the AWS documentation and your service’s resource
policies to determine if this option is appropriate.</p>
<p>When <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-use-unsigned-payload"><span class="std std-ref">use_unsigned_payload</span></a>
is false (the default), requests which exceed the configured buffer limit will receive a 413 response. See the
<a class="reference internal" href="../../../faq/configuration/flow_control.html#faq-flow-control"><span class="std std-ref">flow control docs</span></a> for details.</p>
<p>The <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-match-excluded-headers"><span class="std std-ref">match_excluded_headers</span></a>
option allows excluding certain request headers from being signed. This usually applies to headers that are likely to mutate or
are added later such as in retries. By default, the headers <code class="docutils literal notranslate"><span class="pre">x-forwarded-for</span></code>, <code class="docutils literal notranslate"><span class="pre">x-forwarded-proto</span></code>, and <code class="docutils literal notranslate"><span class="pre">x-amzn-trace-id</span></code> are always excluded.</p>
<p>The <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-signing-algorithm"><span class="std std-ref">signing_algorithm</span></a>
can be specified as <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4</span></code> or <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code>. If the signing algorithm is unspecified, this filter will default to <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4</span></code>.
If <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4</span></code> is unspecified, or explicitly specified, the <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-region"><span class="std std-ref">signing_algorithm</span></a> parameter
is used to define the region to which the sigv4 calculation is addressed to.
If <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code> is explicitly specified, the <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-region"><span class="std std-ref">signing_algorithm</span></a> parameter
is used as a region set. A region set is a single region, or comma seperated list of regions. Regions in a region set can also include wildcards,
such as <code class="docutils literal notranslate"><span class="pre">us-east-*</span></code> or even <code class="docutils literal notranslate"><span class="pre">*</span></code>. By using <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code> and wildcarded regions it is possible to simplify the overall envoy configuration for
multi-region implementations.</p>
<p>Signing can be added to the query string, rather than in the headers, by enabling <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-query-string"><span class="std std-ref">query_string</span></a>
Query string signing adds an additional parameter <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-querystring-expiration-time"><span class="std std-ref">expiration_time</span></a> which determines the
length of time after which this URL becomes invalid, starting from the time the URL is signed.
The default expiration time is 5 seconds, with a maximum of 3600 seconds. It is recommended to keep this value as small as practicable,
as the generated URL is replayable before this time expires.</p>
<section id="header-modification">
<h2>Header Modification<a class="headerlink" href="#header-modification" title="Link to this heading"></a></h2>
<p>Unless the  <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-query-string"><span class="std std-ref">query_string</span></a> signing method is used,
the following HTTP header modifications will be made by this extension:
- The HTTP <code class="docutils literal notranslate"><span class="pre">authorization</span></code> header will be replaced with the calculated SigV4/SigV4A Authorization value
- The <code class="docutils literal notranslate"><span class="pre">x-amz-security-token</span></code> header will be removed, or replaced if a session token is present via credentials
- The <code class="docutils literal notranslate"><span class="pre">x-amz-date</span></code> header will be replaced with the current date
- The <code class="docutils literal notranslate"><span class="pre">x-amz-region-set</span></code> header will replaced if the <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code> signing algorithm is used</p>
</section>
<section id="example-configuration">
<h2>Example configuration<a class="headerlink" href="#example-configuration" title="Link to this heading"></a></h2>
<p>Example filter configuration:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/f29dcefd0a508a4dbcf821d5e7e6614d/aws-request-signing-filter.yaml"><code class="xref download docutils literal notranslate"><span class="pre">aws-request-signing-filter.yaml</span></code></a></span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">25</span><span class="w">          </span><span class="nt">http_filters</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.aws_request_signing</span>
<span class="linenos">27</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">28</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.aws_request_signing.v3.AwsRequestSigning</span>
<span class="linenos">29</span><span class="w">              </span><span class="nt">service_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="linenos">30</span><span class="w">              </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-west-2</span>
<span class="linenos">31</span><span class="w">              </span><span class="nt">use_unsigned_payload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="linenos">32</span><span class="w">              </span><span class="nt">match_excluded_headers</span><span class="p">:</span>
<span class="linenos">33</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-envoy</span>
<span class="linenos">34</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-forwarded</span>
<span class="linenos">35</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">exact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-amzn-trace-id</span>
</pre></div>
</div>
</div>
<p>This filter also supports per route configuration. Below is an example of route-level config overriding the config at the virtual-host level.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/e3ffa42aee7d32dd4d928b729db327ee/aws-request-signing-filter-route-level-override.yaml"><code class="xref download docutils literal notranslate"><span class="pre">aws-request-signing-filter-route-level-override.yaml</span></code></a></span><a class="headerlink" href="#id3" title="Link to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">20</span><span class="w">              </span><span class="nt">routes</span><span class="p">:</span>
<span class="linenos">21</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">match</span><span class="p">:</span>
<span class="linenos">22</span><span class="w">                  </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="linenos">23</span><span class="w">                </span><span class="nt">route</span><span class="p">:</span>
<span class="linenos">24</span><span class="w">                  </span><span class="nt">cluster</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">versioned-cluster</span>
<span class="linenos">25</span><span class="w">                </span><span class="nt">typed_per_filter_config</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">                  </span><span class="nt">envoy.filters.http.aws_request_signing</span><span class="p">:</span>
<span class="linenos">27</span><span class="w">                    </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.aws_request_signing.v3.AwsRequestSigningPerRoute</span>
<span class="linenos">28</span><span class="w">                    </span><span class="nt">aws_request_signing</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">                      </span><span class="nt">service_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s3</span>
<span class="linenos">30</span><span class="w">                      </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">us-west-1</span>
<span class="linenos">31</span><span class="w">                      </span><span class="nt">use_unsigned_payload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="linenos">32</span><span class="w">                      </span><span class="nt">host_rewrite</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">new-host</span>
<span class="linenos">33</span><span class="w">                      </span><span class="nt">match_excluded_headers</span><span class="p">:</span>
<span class="linenos">34</span><span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-envoy</span>
<span class="linenos">35</span><span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-forwarded</span>
<span class="linenos">36</span><span class="w">                      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">exact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-amzn-trace-id</span>
<span class="linenos">37</span><span class="w">                    </span><span class="nt">stat_prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">some-prefix</span>
</pre></div>
</div>
</div>
<p>An example of configuring this filter to use <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code> signing with a wildcarded region set, to an Amazon VPC Lattice service, using query string signing and a 3 second expiration:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/4fea609f59e9de99a96703606fcddded/aws-request-signing-filter-sigv4a.yaml"><code class="xref download docutils literal notranslate"><span class="pre">aws-request-signing-filter-sigv4a.yaml</span></code></a></span><a class="headerlink" href="#id4" title="Link to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">26</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.aws_request_signing</span>
<span class="linenos">27</span><span class="w">            </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">28</span><span class="w">              </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.aws_request_signing.v3.AwsRequestSigning</span>
<span class="linenos">29</span><span class="w">              </span><span class="nt">service_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-lattice-svcs</span>
<span class="linenos">30</span><span class="w">              </span><span class="nt">signing_algorithm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS_SIGV4A</span>
<span class="linenos">31</span><span class="w">              </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="linenos">32</span><span class="w">              </span><span class="nt">query_string</span><span class="p">:</span>
<span class="linenos">33</span><span class="w">                </span><span class="nt">expiration_time</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3s</span>
<span class="linenos">34</span><span class="w">              </span><span class="nt">use_unsigned_payload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="linenos">35</span><span class="w">              </span><span class="nt">match_excluded_headers</span><span class="p">:</span>
<span class="linenos">36</span><span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-envoy</span>
</pre></div>
</div>
</div>
</section>
<section id="configuration-as-an-upstream-http-filter">
<h2>Configuration as an upstream HTTP filter<a class="headerlink" href="#configuration-as-an-upstream-http-filter" title="Link to this heading"></a></h2>
<p>SigV4 or SigV4A request signatures are calculated using the HTTP host, URL and payload as input. Depending on the configuration, Envoy may modify one or more of
these prior to forwarding to the Cluster subsystem, but after the signature has been calculated and inserted into the HTTP headers or query string.
Modifying fields in a SigV4 or SigV4A signed request will result in an invalid signature.</p>
<p>To avoid invalid signatures, the AWS Request Signing Filter can be configured as an upstream HTTP filter. This allows signatures to be
calculated as a final step before the HTTP request is forwarded upstream, ensuring signatures are correctly calculated over the updated
HTTP fields.</p>
<p>Configuring this filter as an upstream HTTP filter is done in a similar way to the downstream case, but using the <a class="reference internal" href="../../../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-http-filters"><span class="std std-ref">http_filters</span></a>
filter chain within the cluster configuration.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><a class="reference download internal" download="" href="../../../_downloads/252ba301fd0eacb4e15f2f75561ffa76/aws-request-signing-filter-upstream.yaml"><code class="xref download docutils literal notranslate"><span class="pre">aws-request-signing-filter-upstream.yaml</span></code></a></span><a class="headerlink" href="#id5" title="Link to this code"></a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">47</span><span class="w">          </span><span class="nt">typed_config</span><span class="p">:</span>
<span class="linenos">48</span><span class="w">            </span><span class="s">&quot;@type&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type.googleapis.com/envoy.extensions.filters.http.aws_request_signing.v3.AwsRequestSigning</span>
<span class="linenos">49</span><span class="w">            </span><span class="nt">service_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vpc-lattice-svcs</span>
<span class="linenos">50</span><span class="w">            </span><span class="nt">region</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;*&#39;</span>
<span class="linenos">51</span><span class="w">            </span><span class="nt">signing_algorithm</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS_SIGV4A</span>
<span class="linenos">52</span><span class="w">            </span><span class="nt">use_unsigned_payload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="linenos">53</span><span class="w">            </span><span class="nt">match_excluded_headers</span><span class="p">:</span>
<span class="linenos">54</span><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-envoy</span>
<span class="linenos">55</span><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-forwarded</span>
<span class="linenos">56</span><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">exact</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">x-amzn-trace-id</span>
<span class="linenos">57</span><span class="w">       </span><span class="w w-Error"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">envoy.filters.http.upstream_codec</span>
</pre></div>
</div>
</div>
</section>
<section id="credentials">
<h2>Credentials<a class="headerlink" href="#credentials" title="Link to this heading"></a></h2>
<p>The filter uses a number of different credentials providers to obtain an AWS access key ID, AWS secret access key, and AWS session token.
It moves through the credentials providers in the order described below, stopping when one of them returns an access key ID and a
secret access key (the session token is optional).</p>
<ol class="arabic">
<li><p>Environment variables. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_ACCESS_KEY_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_SECRET_ACCESS_KEY</span></code>, and <code class="docutils literal notranslate"><span class="pre">AWS_SESSION_TOKEN</span></code> are used.</p></li>
<li><p>The AWS credentials file. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_SHARED_CREDENTIALS_FILE</span></code> and <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE</span></code> are respected if they are set, else
the file <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> and profile <code class="docutils literal notranslate"><span class="pre">default</span></code> are used. The fields <code class="docutils literal notranslate"><span class="pre">aws_access_key_id</span></code>, <code class="docutils literal notranslate"><span class="pre">aws_secret_access_key</span></code>, and
<code class="docutils literal notranslate"><span class="pre">aws_session_token</span></code> defined for the profile in the credentials file are used. These credentials are cached for 1 hour.</p></li>
<li><p>From <a class="reference external" href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">AssumeRoleWithWebIdentity</a> API call
towards AWS Security Token Service using <code class="docutils literal notranslate"><span class="pre">WebIdentityToken</span></code> read from a file pointed by <code class="docutils literal notranslate"><span class="pre">AWS_WEB_IDENTITY_TOKEN_FILE</span></code> environment
variable and role arn read from <code class="docutils literal notranslate"><span class="pre">AWS_ROLE_ARN</span></code> environment variable. The credentials are extracted from the fields <code class="docutils literal notranslate"><span class="pre">AccessKeyId</span></code>,
<code class="docutils literal notranslate"><span class="pre">SecretAccessKey</span></code>, and <code class="docutils literal notranslate"><span class="pre">SessionToken</span></code> are used, and credentials are cached for 1 hour or until they expire (according to the field
<code class="docutils literal notranslate"><span class="pre">Expiration</span></code>). To enable this credentials provider set <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_http_client_to_fetch_aws_credentials</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>
so that it can use http async client to fetch the credentials. This provider is not compatible with <a class="reference internal" href="../../../api-v3/config/grpc_credential/v3/aws_iam.proto.html#envoy-v3-api-file-envoy-config-grpc-credential-v3-aws-iam-proto"><span class="std std-ref">Grpc Credentials AWS AwsIamConfig</span></a> plugin which can only support deprecated libcurl credentials
fetcher (see <a class="reference external" href="https://github.com/envoyproxy/envoy/pull/30626">issue #30626</a>). To fetch the credentials a static cluster is created with the name
<code class="docutils literal notranslate"><span class="pre">sts_token_service_internal-&lt;region&gt;</span></code> pointing towards regional AWS Security Token Service.</p>
<p>Note: If <code class="docutils literal notranslate"><span class="pre">signing_algorithm:</span> <span class="pre">AWS_SIGV4A</span></code> is set, the logic for STS cluster host generation is as follows:
- If the <code class="docutils literal notranslate"><span class="pre">region</span></code> is configured (either through profile, environment or inline) as a SigV4A region set
- And if the first region in the region set contains a wildcard
- Then STS cluster host is set to <code class="docutils literal notranslate"><span class="pre">sts.amazonaws.com</span></code> (or <code class="docutils literal notranslate"><span class="pre">sts-fips.us-east-1.amazonaws.com</span></code> if compiled with FIPS support
- Else STS cluster host is set to <code class="docutils literal notranslate"><span class="pre">sts.&lt;first</span> <span class="pre">region</span> <span class="pre">in</span> <span class="pre">region</span> <span class="pre">set&gt;.amazonaws.com</span></code></p>
</li>
</ol>
<blockquote>
<div><p>If you require the use of SigV4A signing and you are using an alternate partition, such as cn or GovCloud, you can ensure correct generation
of the STS endpoint by setting the first region in your SigV4A region set to the correct region (such as <code class="docutils literal notranslate"><span class="pre">cn-northwest-1</span></code> with no wildcard)</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>Either EC2 instance metadata, ECS task metadata or EKS Pod Identity.
For EC2 instance metadata, the fields <code class="docutils literal notranslate"><span class="pre">AccessKeyId</span></code>, <code class="docutils literal notranslate"><span class="pre">SecretAccessKey</span></code>, and <code class="docutils literal notranslate"><span class="pre">Token</span></code> are used, and credentials are cached for 1 hour.
For ECS task metadata, the fields <code class="docutils literal notranslate"><span class="pre">AccessKeyId</span></code>, <code class="docutils literal notranslate"><span class="pre">SecretAccessKey</span></code>, and <code class="docutils literal notranslate"><span class="pre">Token</span></code> are used, and credentials are cached for 1 hour or
until they expire (according to the field <code class="docutils literal notranslate"><span class="pre">Expiration</span></code>).
For EKS Pod Identity, The environment variable <code class="docutils literal notranslate"><span class="pre">AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE</span></code> will point to a mounted file in the container,
containing the string required in the Authorization header sent to the EKS Pod Identity Agent. The fields <code class="docutils literal notranslate"><span class="pre">AccessKeyId</span></code>, <code class="docutils literal notranslate"><span class="pre">SecretAccessKey</span></code>,
and <code class="docutils literal notranslate"><span class="pre">Token</span></code> are used, and credentials are cached for 1 hour or until they expire (according to the field <code class="docutils literal notranslate"><span class="pre">Expiration</span></code>).
Note that the latest update on AWS credentials provider utility provides an option to use http async client functionality instead of libcurl
to fetch the credentials. This behavior can be changed by setting <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_http_client_to_fetch_aws_credentials</span></code> to <code class="docutils literal notranslate"><span class="pre">true</span></code>.
The usage of libcurl is on the deprecation path and will be removed soon. To fetch the credentials from either EC2 instance
metadata or ECS task metadata a static cluster is required pointing towards the credentials provider. The static cluster name has to be
<code class="docutils literal notranslate"><span class="pre">ec2_instance_metadata_server_internal</span></code> for fetching from EC2 instance metadata or <code class="docutils literal notranslate"><span class="pre">ecs_task_metadata_server_internal</span></code> for fetching
from ECS task metadata. If these clusters are not provided in the bootstrap configuration then either of these will be added by default.
The static internal cluster will still be added even if initially <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_http_client_to_fetch_aws_credentials</span></code> is
not set so that subsequently if the reloadable feature is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> the cluster config is available to fetch the credentials.</p></li>
</ol>
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Link to this heading"></a></h2>
<p>When using the <code class="docutils literal notranslate"><span class="pre">envoy.reloadable_features.use_http_client_to_fetch_aws_credentials</span></code> reloadable feature, the following
statistics are output under the <code class="docutils literal notranslate"><span class="pre">aws.metadata_credentials_provider</span></code> namespace:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt;provider_cluster&gt;.credential_refreshes_performed</p></td>
<td><p>Counter</p></td>
<td><p>Total credential refreshes performed by this cluster</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;provider_cluster&gt;.credential_refreshes_failed</p></td>
<td><p>Counter</p></td>
<td><p>Total credential refreshes failed by this cluster. For example, this would be incremented if a WebIdentity token was expired</p></td>
</tr>
<tr class="row-even"><td><p>&lt;provider_cluster&gt;.credential_refreshes_succeeded</p></td>
<td><p>Counter</p></td>
<td><p>Total successful credential refreshes for this cluster. Successful refresh would indicate credentials are available for signing</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;provider_cluster&gt;.metadata_refresh_state</p></td>
<td><p>Gauge</p></td>
<td><p>0 means the cluster is in initial refresh state, ie no successful credential refreshes have been performed. In 0 state the cluster will attempt credential refresh up to a maximum of once every 30 seconds. 1 means the cluster is in normal credential expiration based refresh state</p></td>
</tr>
<tr class="row-even"><td><p>&lt;provider_cluster&gt;.clusters_removed_by_cds</p></td>
<td><p>Counter</p></td>
<td><p>Number of metadata clusters removed during CDS refresh</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;provider_cluster&gt;.clusters_readded_after_cds</p></td>
<td><p>Counter</p></td>
<td><p>Number of metadata clusters replaced when CDS deletion occurs</p></td>
</tr>
</tbody>
</table>
</section>
<section id="regions">
<span id="config-http-filters-aws-request-signing-region"></span><h2>Regions<a class="headerlink" href="#regions" title="Link to this heading"></a></h2>
<p>In a similar way to retrieving credentials, the region can be sourced from a number of locations. In order, these are the locations which are
checked, which align with the AWS SDK behavior:</p>
<p>If <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-signing-algorithm"><span class="std std-ref">signing_algorithm</span></a> is <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4</span></code>:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">region</span></code> parameter in the extension xDS configuration. For the <code class="docutils literal notranslate"><span class="pre">aws_request_signing</span></code> filter, this is the
<a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-region"><span class="std std-ref">region</span></a> optional parameter.</p></li>
<li><p>Environment variables. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_REGION</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_DEFAULT_REGION</span></code> are used.</p></li>
<li><p>The AWS credentials file. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_SHARED_CREDENTIALS_FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFAULT_AWS_PROFILE</span></code>
are respected if they are set, else the file <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> and profile <code class="docutils literal notranslate"><span class="pre">default</span></code> are used. The field <code class="docutils literal notranslate"><span class="pre">region</span></code> defined
for the profile in the credentials file is used.</p></li>
<li><p>The AWS config file. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_CONFIG_FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE``and</span> <span class="pre">``DEFAULT_AWS_PROFILE</span></code> are
respected if they are set, else the file <code class="docutils literal notranslate"><span class="pre">~/.aws/config</span></code> and profile <code class="docutils literal notranslate"><span class="pre">default</span></code> are used. The field <code class="docutils literal notranslate"><span class="pre">region</span></code> defined for the
profile in the config file is used.</p></li>
</ol>
<p>If <a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-signing-algorithm"><span class="std std-ref">signing_algorithm</span></a> is <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A</span></code>:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">region</span></code> parameter in the extension xDS configuration. For the <code class="docutils literal notranslate"><span class="pre">aws_request_signing</span></code> filter, this is the
<a class="reference internal" href="../../../api-v3/extensions/filters/http/aws_request_signing/v3/aws_request_signing.proto.html#envoy-v3-api-field-extensions-filters-http-aws-request-signing-v3-awsrequestsigning-region"><span class="std std-ref">region</span></a> optional parameter.</p></li>
<li><p>Environment variables. The environment variable <code class="docutils literal notranslate"><span class="pre">AWS_SIGV4A_SIGNING_REGION_SET</span></code> is used.</p></li>
<li><p>The AWS credentials file. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_SHARED_CREDENTIALS_FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFAULT_AWS_PROFILE</span></code>
are respected if they are set, else the file <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> and profile <code class="docutils literal notranslate"><span class="pre">default</span></code> are used. The field
<code class="docutils literal notranslate"><span class="pre">sigv4a_signing_region_set</span></code> defined for the profile in the credentials file is used.</p></li>
<li><p>The AWS config file. The environment variables <code class="docutils literal notranslate"><span class="pre">AWS_CONFIG_FILE</span></code>, <code class="docutils literal notranslate"><span class="pre">AWS_PROFILE``and</span> <span class="pre">``DEFAULT_AWS_PROFILE</span></code> are
respected if they are set, else the file <code class="docutils literal notranslate"><span class="pre">~/.aws/config</span></code> and profile <code class="docutils literal notranslate"><span class="pre">default</span></code> are used. The field <code class="docutils literal notranslate"><span class="pre">sigv4a_signing_region_set</span></code>
defined for the profile in the config file is used.</p></li>
</ol>
</section>
<section id="id1">
<h2>Statistics<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>The AWS request signing filter outputs statistics in the <em>http.&lt;stat_prefix&gt;.aws_request_signing.</em> namespace. The
<a class="reference internal" href="../../../api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto.html#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stat-prefix"><span class="std std-ref">stat prefix</span></a>
comes from the owning HTTP connection manager.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>signing_added</p></td>
<td><p>Counter</p></td>
<td><p>Total requests for which signing succeeded (includes payload_signing_added)</p></td>
</tr>
<tr class="row-odd"><td><p>signing_failed</p></td>
<td><p>Counter</p></td>
<td><p>Total requests for which signing failed (includes payload_signing_failed)</p></td>
</tr>
<tr class="row-even"><td><p>payload_signing_added</p></td>
<td><p>Counter</p></td>
<td><p>Total requests for which the payload was buffered signing succeeded</p></td>
</tr>
<tr class="row-odd"><td><p>payload_signing_failed</p></td>
<td><p>Counter</p></td>
<td><p>Total requests for which the payload was buffered but signing failed</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="aws_lambda_filter.html" class="btn btn-neutral float-left" title="AWS Lambda" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="bandwidth_limit_filter.html" class="btn btn-neutral float-right" title="Bandwidth limit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2025, Envoy Project Authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>